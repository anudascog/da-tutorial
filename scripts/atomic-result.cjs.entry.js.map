{"file":"atomic-result.entry.cjs.js","mappings":"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","names":["ItemLayout","parentNodeToString","h","Host","resultComponentClass"],"sources":["src/components/search/atomic-result/atomic-result.pcss?tag=atomic-result&encapsulation=shadow","src/components/search/atomic-result/atomic-result.tsx"],"sourcesContent":["@import '../../common/template-system/template-system.pcss';\n\n:host {\n  @apply atomic-template-system;\n}\n","import {FoldedResult, InteractiveResult, Result} from '@coveo/headless';\nimport {Component, h, Prop, Element, Listen, Host} from '@stencil/core';\nimport {parentNodeToString} from '../../../utils/dom-utils';\nimport {DisplayConfig} from '../../common/item-list/item-decorators';\nimport {\n  ItemRenderingFunction,\n  resultComponentClass,\n} from '../../common/item-list/stencil-item-list-common';\nimport {\n  ItemLayout,\n  ItemDisplayDensity,\n  ItemDisplayImageSize,\n  ItemDisplayLayout,\n} from '../../common/layout/display-options';\nimport {SearchStore} from '../atomic-search-interface/store';\nimport {\n  InteractiveResultContextEvent,\n  ResultContextEvent,\n} from '../result-template-components/result-template-decorators';\n\n/**\n * The `atomic-result` component is used internally by the `atomic-result-list` component.\n */\n@Component({\n  tag: 'atomic-result',\n  styleUrl: 'atomic-result.pcss',\n  shadow: true,\n})\nexport class AtomicResult {\n  private layout!: ItemLayout;\n\n  @Element() host!: HTMLElement;\n\n  /**\n   * Whether an atomic-result-link inside atomic-result should stop click event propagation.\n   */\n  @Prop() stopPropagation?: boolean;\n\n  /**\n   * The result item.\n   */\n  @Prop() result!: Result | FoldedResult;\n\n  /**\n   * The InteractiveResult item.\n   * @internal\n   */\n  @Prop() interactiveResult!: InteractiveResult;\n\n  /**\n   * Global Atomic state.\n   * @internal\n   */\n  @Prop() store?: SearchStore;\n\n  /**\n   * The result content to display.\n   */\n  @Prop() content?: ParentNode;\n\n  /**\n   * The result link to use when the result is clicked in a grid layout.\n   *\n   * @default - An `atomic-result-link` without any customization.\n   */\n  @Prop() linkContent: ParentNode = new DocumentFragment();\n\n  /**\n   * How results should be displayed.\n   */\n  @Prop() display: ItemDisplayLayout = 'list';\n\n  /**\n   * How large or small results should be.\n   */\n  @Prop() density: ItemDisplayDensity = 'normal';\n\n  /**\n   * The size of the visual section in result list items.\n   *\n   * This is overwritten by the image size defined in the result content, if it exists.\n   */\n  @Prop() imageSize: ItemDisplayImageSize = 'icon';\n\n  /**\n   * The classes to add to the result element.\n   */\n  @Prop() classes = '';\n\n  /**\n   * @internal\n   */\n  @Prop() loadingFlag?: string;\n\n  /**\n   * Internal function used by atomic-recs-list in advanced setups, which lets you bypass the standard HTML template system.\n   * Particularly useful for Atomic React\n   *\n   * @internal\n   */\n  @Prop() renderingFunction: ItemRenderingFunction;\n\n  private resultRootRef?: HTMLElement;\n  private linkContainerRef?: HTMLElement;\n  private executedRenderingFunctionOnce = false;\n\n  @Listen('atomic/resolveResult')\n  public resolveResult(event: ResultContextEvent<FoldedResult | Result>) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail(this.result);\n  }\n\n  @Listen('atomic/resolveInteractiveResult')\n  public resolveInteractiveResult(event: InteractiveResultContextEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.interactiveResult) {\n      event.detail(this.interactiveResult);\n    }\n  }\n\n  @Listen('atomic/resolveStopPropagation')\n  public resolveStopPropagation(event: CustomEvent) {\n    event.detail(this.stopPropagation);\n  }\n\n  @Listen('atomic/resolveResultDisplayConfig')\n  public resolveResultDisplayConfig(event: ResultContextEvent<DisplayConfig>) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail({\n      density: this.density,\n      imageSize: this.imageSize!,\n    });\n  }\n\n  @Listen('click')\n  public handleClick(event: MouseEvent) {\n    if (this.stopPropagation) {\n      event.stopPropagation();\n    }\n    this.host\n      .shadowRoot!.querySelector<HTMLAnchorElement>(\n        '.link-container > atomic-result-link a:not([slot])'\n      )\n      ?.click();\n  }\n\n  public connectedCallback() {\n    this.layout = new ItemLayout(\n      this.content!.children,\n      this.display,\n      this.density,\n      this.imageSize\n    );\n  }\n\n  private get isCustomRenderFunctionMode() {\n    return this.renderingFunction !== undefined;\n  }\n\n  private getContentHTML() {\n    return parentNodeToString(this.content!);\n  }\n\n  private getLinkHTML() {\n    return parentNodeToString(this.linkContent);\n  }\n\n  private shouldExecuteRenderFunction() {\n    return (\n      this.isCustomRenderFunctionMode &&\n      this.resultRootRef &&\n      !this.executedRenderingFunctionOnce\n    );\n  }\n\n  public render() {\n    if (this.isCustomRenderFunctionMode) {\n      return (\n        <Host class={resultComponentClass}>\n          <div\n            class=\"result-root\"\n            ref={(ref) => (this.resultRootRef = ref)}\n          ></div>\n          <div\n            class=\"link-container\"\n            ref={(ref) => (this.linkContainerRef = ref)}\n          ></div>\n        </Host>\n      );\n    }\n    return (\n      <Host class={resultComponentClass}>\n        <div\n          class={`result-root ${this.layout\n            .getClasses()\n            .concat(this.classes)\n            .join(' ')}`}\n          innerHTML={this.getContentHTML()}\n        ></div>\n        <div class=\"link-container\" innerHTML={this.getLinkHTML()}></div>\n      </Host>\n    );\n  }\n\n  public componentDidLoad() {\n    if (this.loadingFlag && this.store) {\n      this.store.unsetLoadingFlag(this.loadingFlag);\n    }\n    this.host.classList.add('hydrated');\n  }\n\n  public componentDidRender() {\n    if (this.shouldExecuteRenderFunction()) {\n      const customRenderOutputAsString = this.renderingFunction!(\n        this.result,\n        this.resultRootRef!,\n        this.linkContainerRef!\n      );\n\n      this.resultRootRef!.className += ` ${this.layout\n        .getClasses(customRenderOutputAsString)\n        .concat(this.classes)\n        .join(' ')}`;\n\n      this.executedRenderingFunctionOnce = true;\n    }\n    this.host.classList.add('hydrated');\n  }\n}\n"],"version":3}