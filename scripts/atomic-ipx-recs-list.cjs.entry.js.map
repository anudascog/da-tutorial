{"file":"atomic-ipx-recs-list.entry.cjs.js","mappings":"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","names":["randomID","buildRecommendationList","ItemTemplateProvider","ItemListCommon","loadIPXActionsHistoryActions","createAppLoadedListener","FocusTargetController","NumberValue","loadConfigurationActions","h","Heading","recommendation","buildRecsInteractiveResult","getItemListDisplayClasses","DisplayGrid","DisplayWrapper","ResultsPlaceholdersGuard","ItemDisplayGuard","Fragment","Carousel","InitializeBindings","BindStateToController"],"sources":["src/components/ipx/atomic-ipx-recs-list/atomic-recs-list/atomic-ipx-recs-list.pcss?tag=atomic-ipx-recs-list&encapsulation=shadow","src/components/ipx/atomic-ipx-recs-list/atomic-recs-list/atomic-ipx-recs-list.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\n@import '../../../common/item-list/styles/mixins.pcss';\n@import '../../../common/item-list/styles/placeholders.pcss';\n\n:host {\n  @apply atomic-grid-clickable-elements;\n  @apply atomic-grid-display-common;\n  display: block;\n\n  /**\n * @prop --atomic-recs-number-of-columns: Number of columns for the recommendation list.\n */\n  .list-root {\n    @apply atomic-grid-with-cards;\n    grid-template-columns: repeat(var(--atomic-recs-number-of-columns, 1), minmax(0, 1fr));\n  }\n\n  [part='label'] {\n    @apply font-sans text-2xl font-bold;\n  }\n\n  atomic-result:not(.hydrated) {\n    visibility: hidden;\n  }\n}\n","import {NumberValue} from '@coveo/bueno';\nimport {\n  IPXActionsHistoryActionCreators,\n  loadIPXActionsHistoryActions,\n} from '@coveo/headless';\nimport {\n  buildRecommendationList,\n  RecommendationList,\n  RecommendationListState,\n  loadConfigurationActions,\n  Result as RecsResult,\n  buildInteractiveResult as buildRecsInteractiveResult,\n} from '@coveo/headless/recommendation';\nimport {\n  Component,\n  State,\n  Element,\n  Prop,\n  Method,\n  h,\n  Fragment,\n  Watch,\n} from '@stencil/core';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n  BindStateToController,\n} from '../../../../utils/initialization-utils';\nimport {FocusTargetController} from '../../../../utils/stencil-accessibility-utils';\nimport {randomID} from '../../../../utils/utils';\nimport {ResultsPlaceholdersGuard} from '../../../common/atomic-result-placeholder/stencil-placeholders';\nimport {createAppLoadedListener} from '../../../common/interface/store';\nimport {ItemDisplayGuard} from '../../../common/item-list/item-display-guard';\nimport {ItemTemplateProvider} from '../../../common/item-list/item-template-provider';\nimport {DisplayGrid} from '../../../common/item-list/stencil-display-grid';\nimport {DisplayWrapper} from '../../../common/item-list/stencil-display-wrapper';\nimport {\n  ItemListCommon,\n  ItemRenderingFunction,\n} from '../../../common/item-list/stencil-item-list-common';\nimport {\n  getItemListDisplayClasses,\n  ItemDisplayBasicLayout,\n  ItemDisplayDensity,\n  ItemDisplayImageSize,\n} from '../../../common/layout/display-options';\nimport {Carousel} from '../../../common/stencil-carousel';\nimport {Heading} from '../../../common/stencil-heading';\nimport {RecsBindings} from '../../../recommendations/atomic-recs-interface/atomic-recs-interface';\n\n/**\n * The `atomic-ipx-recs-list` component displays recommendations by applying one or more result templates.\n *\n * @part result-list - The element containing the list of results.\n * @part result-list-grid-clickable-container - The parent of the result & the clickable link encompassing it.\n * @part result-list-grid-clickable - The clickable link encompassing the result.\n * @part label - The label of the result list.\n * @part previous-button - The previous button.\n * @part next-button - The next button.\n * @part indicators - The list of indicators.\n * @part indicator - A single indicator.\n * @part active-indicator - The active indicator.\n * @internal\n */\n@Component({\n  tag: 'atomic-ipx-recs-list',\n  styleUrl: 'atomic-ipx-recs-list.pcss',\n  shadow: true,\n})\nexport class AtomicIPXRecsList implements InitializableComponent<RecsBindings> {\n  @InitializeBindings() public bindings!: RecsBindings;\n  public recommendationList!: RecommendationList;\n  private loadingFlag = randomID('firstRecommendationLoaded-');\n  private itemRenderingFunction: ItemRenderingFunction;\n  private itemTemplateProvider!: ItemTemplateProvider;\n  private nextNewResultTarget?: FocusTargetController;\n  private itemListCommon!: ItemListCommon;\n  private actionsHistoryActions?: IPXActionsHistoryActionCreators;\n\n  @Element() public host!: HTMLDivElement;\n\n  @State() public error!: Error;\n  @State() private isAppLoaded = false;\n  @State() private resultTemplateRegistered = false;\n  @State() private templateHasError = false;\n  @State() private currentPage = 0;\n  @BindStateToController('recommendationList')\n  @State()\n  public recommendationListState!: RecommendationListState;\n\n  /**\n   * The Recommendation identifier used by the Coveo platform to retrieve recommended documents.\n   * Make sure to set a different value for each atomic-ipx-recs-list in your page.\n   */\n  @Prop({reflect: true}) public recommendation = 'Recommendation';\n\n  /**\n   * The layout to apply when displaying results themselves. This does not affect the display of the surrounding list itself.\n   * To modify the number of recommendations per column, modify the --atomic-recs-number-of-columns CSS variable.\n   */\n  @Prop({reflect: true}) public display: ItemDisplayBasicLayout = 'list';\n  /**\n   * The spacing of various elements in the result list, including the gap between results, the gap between parts of a result, and the font sizes of different parts in a result.\n   */\n  @Prop({reflect: true}) public density: ItemDisplayDensity = 'normal';\n  /**\n   * The expected size of the image displayed in the results.\n   */\n  @Prop({reflect: true})\n  public imageSize: ItemDisplayImageSize = 'small';\n\n  /**\n   * The total number of recommendations to display.\n   * This does not modify the number of recommendations per column. To do so, modify the --atomic-recs-number-of-columns CSS variable.\n   */\n  @Prop({reflect: true}) public numberOfRecommendations = 10;\n\n  /**\n   * The number of recommendations to display, per page.\n   * Setting a value greater than and lower than the numberOfRecommendations value activates the carousel.\n   * This does not affect the display of the list itself, only the number of recommendation pages.\n   */\n  @Prop({reflect: true}) public numberOfRecommendationsPerPage?: number;\n\n  /**\n   * The non-localized label for the list of recommendations.\n   */\n  @Prop({reflect: true}) public label?: string;\n\n  /**\n   * The [heading level](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements) to use for the heading label, from 1 to 6.\n   */\n  @Prop({reflect: true}) public headingLevel = 0;\n\n  @Watch('numberOfRecommendationsPerPage')\n  public async watchNumberOfRecommendationsPerPage() {\n    this.currentPage = 0;\n  }\n\n  /**\n   * Sets a rendering function to bypass the standard HTML template mechanism for rendering results.\n   * You can use this function while working with web frameworks that don't use plain HTML syntax, e.g., React, Angular or Vue.\n   *\n   * Do not use this method if you integrate Atomic in a plain HTML deployment.\n   *\n   * @param resultRenderingFunction\n   */\n  @Method() public async setRenderFunction(\n    resultRenderingFunction: ItemRenderingFunction\n  ) {\n    this.itemRenderingFunction = resultRenderingFunction;\n  }\n\n  /**\n   * Moves to the previous page, when the carousel is activated.\n   */\n  @Method() public async previousPage() {\n    this.currentPage =\n      this.currentPage - 1 < 0 ? this.numberOfPages - 1 : this.currentPage - 1;\n  }\n\n  /**\n   * Moves to the next page, when the carousel is activated.\n   */\n  @Method() public async nextPage() {\n    this.currentPage = (this.currentPage + 1) % this.numberOfPages;\n  }\n\n  public initialize() {\n    this.validateNumberOfRecommendationsPerPage();\n    this.validateRecommendationIdentifier();\n    this.updateOriginLevel2();\n    this.recommendationList = buildRecommendationList(this.bindings.engine, {\n      options: {\n        id: this.recommendation,\n        numberOfRecommendations: this.numberOfRecommendations,\n      },\n    });\n\n    this.itemTemplateProvider = new ItemTemplateProvider({\n      includeDefaultTemplate: true,\n      templateElements: Array.from(\n        this.host.querySelectorAll('atomic-recs-result-template')\n      ),\n      getResultTemplateRegistered: () => this.resultTemplateRegistered,\n      getTemplateHasError: () => this.templateHasError,\n      setResultTemplateRegistered: (value: boolean) => {\n        this.resultTemplateRegistered = value;\n      },\n      setTemplateHasError: (value: boolean) => {\n        this.templateHasError = value;\n      },\n      bindings: this.bindings,\n    });\n\n    this.itemListCommon = new ItemListCommon({\n      engineSubscribe: this.bindings.engine.subscribe,\n      getCurrentNumberOfItems: () =>\n        this.recommendationListState.recommendations.length,\n      getIsLoading: () => this.recommendationListState.isLoading,\n      host: this.host,\n      loadingFlag: this.loadingFlag,\n      nextNewItemTarget: this.focusTarget,\n      store: this.bindings.store,\n    });\n    this.actionsHistoryActions = loadIPXActionsHistoryActions(\n      this.bindings.engine\n    );\n\n    createAppLoadedListener(this.bindings.store, (isAppLoaded) => {\n      this.isAppLoaded = isAppLoaded;\n    });\n  }\n\n  public get focusTarget() {\n    if (!this.nextNewResultTarget) {\n      this.nextNewResultTarget = new FocusTargetController(this);\n    }\n    return this.nextNewResultTarget;\n  }\n\n  private get recommendationListStateWithAugment() {\n    return {\n      ...this.recommendationListState,\n      firstRequestExecuted:\n        this.recommendationListState.searchResponseId !== '',\n      hasError: this.recommendationListState.error !== null,\n      hasItems: this.recommendationListState.recommendations.length !== 0,\n      results: this.subsetRecommendations,\n    };\n  }\n\n  private validateNumberOfRecommendationsPerPage() {\n    const msg = new NumberValue({\n      min: 1,\n      max: this.numberOfRecommendations - 1,\n    }).validate(this.numberOfRecommendationsPerPage!);\n\n    if (msg) {\n      this.error = new Error(\n        `The \"numberOfRecommendationsPerPage\" is invalid: ${msg}`\n      );\n    }\n  }\n\n  private validateRecommendationIdentifier() {\n    const recListWithRecommendation = document.querySelectorAll(\n      `atomic-ipx-recs-list[recommendation=\"${this.recommendation}\"]`\n    );\n\n    if (recListWithRecommendation.length > 1) {\n      this.bindings.engine.logger.warn(\n        `There are multiple atomic-ipx-recs-list in this page with the same recommendation property \"${this.recommendation}\". Make sure to set a different recommendation property for each.`\n      );\n    }\n  }\n\n  private updateOriginLevel2() {\n    if (this.label) {\n      const action = loadConfigurationActions(\n        this.bindings.engine\n      ).setOriginLevel2({\n        originLevel2: this.label,\n      });\n\n      this.bindings.engine.dispatch(action);\n    }\n  }\n\n  private renderHeading() {\n    if (!this.label) {\n      return;\n    }\n\n    if (this.recommendationListStateWithAugment.hasError) {\n      return;\n    }\n\n    if (\n      this.recommendationListStateWithAugment.firstRequestExecuted &&\n      !this.recommendationListStateWithAugment.hasItems\n    ) {\n      return;\n    }\n\n    return (\n      <Heading level={this.headingLevel} part=\"label\" class=\"m-0 mb-2\">\n        {this.bindings.i18n.t(this.label)}\n      </Heading>\n    );\n  }\n\n  private get currentIndex() {\n    return Math.abs(\n      (this.currentPage * this.numberOfRecommendationsPerPage!) %\n        this.recommendationListState.recommendations.length\n    );\n  }\n\n  private get subsetRecommendations() {\n    if (!this.numberOfRecommendationsPerPage) {\n      return this.recommendationListState.recommendations;\n    }\n\n    return this.recommendationListState.recommendations.slice(\n      this.currentIndex,\n      this.currentIndex + this.numberOfRecommendationsPerPage\n    );\n  }\n\n  private get numberOfPages() {\n    return Math.ceil(\n      this.recommendationListState.recommendations.length /\n        this.numberOfRecommendationsPerPage!\n    );\n  }\n\n  private get hasPagination() {\n    return !!this.numberOfRecommendationsPerPage;\n  }\n\n  private get shouldRenderPagination() {\n    return (\n      this.hasPagination && this.recommendationListStateWithAugment.hasItems\n    );\n  }\n\n  private async onSelect(\n    recommendation: RecsResult,\n    originalSelect: () => void\n  ) {\n    if (recommendation.raw.permanentid && this.actionsHistoryActions) {\n      const action =\n        this.actionsHistoryActions.addPageViewEntryInActionsHistory(\n          recommendation.raw.permanentid\n        );\n      this.bindings.engine.dispatch(action);\n    }\n    originalSelect();\n  }\n\n  private getPropsForAtomicRecsResult(recommendation: RecsResult) {\n    const interactiveResult = buildRecsInteractiveResult(this.bindings.engine, {\n      options: {result: recommendation},\n    });\n    const originalSelect = interactiveResult.select;\n    interactiveResult.select = () => {\n      this.onSelect(recommendation, originalSelect);\n    };\n    const linkContent =\n      this.itemTemplateProvider.getLinkTemplateContent(recommendation);\n\n    return {\n      interactiveResult,\n      result: recommendation,\n      renderingFunction: this.itemRenderingFunction,\n      loadingFlag: this.loadingFlag,\n      key: this.itemListCommon.getResultId(\n        recommendation.uniqueId,\n        this.recommendationListState.searchResponseId,\n        this.density,\n        this.imageSize\n      ),\n      content: this.itemTemplateProvider.getTemplateContent(recommendation),\n      linkContent,\n      stopPropagation: !!linkContent,\n      store: this.bindings.store,\n      density: this.density,\n      display: this.display,\n      imageSize: this.imageSize,\n    };\n  }\n\n  private computeListDisplayClasses() {\n    const displayPlaceholders = !this.isAppLoaded;\n\n    return getItemListDisplayClasses(\n      'grid',\n      this.density,\n      this.imageSize,\n      this.recommendationListState.isLoading,\n      displayPlaceholders\n    );\n  }\n\n  private renderAsGrid(recommendation: RecsResult, i: number) {\n    const propsForAtomicRecsResult =\n      this.getPropsForAtomicRecsResult(recommendation);\n    return (\n      <DisplayGrid\n        selectorForItem=\"atomic-recs-result\"\n        item={recommendation}\n        {...propsForAtomicRecsResult.interactiveResult}\n        setRef={(element) =>\n          element && this.itemListCommon.setNewResultRef(element, i)\n        }\n      >\n        <atomic-recs-result {...propsForAtomicRecsResult}></atomic-recs-result>\n      </DisplayGrid>\n    );\n  }\n\n  private renderListOfRecommendations() {\n    this.itemListCommon.updateBreakpoints();\n    const listClasses = this.computeListDisplayClasses();\n\n    if (\n      !this.resultTemplateRegistered ||\n      this.itemTemplateProvider.hasError ||\n      this.error\n    ) {\n      return;\n    }\n\n    return (\n      <DisplayWrapper listClasses={listClasses} display=\"grid\">\n        <ResultsPlaceholdersGuard\n          density={this.density}\n          display={this.display}\n          imageSize={this.imageSize}\n          displayPlaceholders={!this.isAppLoaded}\n          numberOfPlaceholders={\n            this.numberOfRecommendationsPerPage ?? this.numberOfRecommendations\n          }\n        ></ResultsPlaceholdersGuard>\n        <ItemDisplayGuard {...this.recommendationListStateWithAugment}>\n          {this.subsetRecommendations.map((recommendation, i) => {\n            return this.renderAsGrid(recommendation, i);\n          })}\n        </ItemDisplayGuard>\n      </DisplayWrapper>\n    );\n  }\n\n  public render() {\n    return (\n      <Fragment>\n        {this.renderHeading()}\n        {this.shouldRenderPagination ? (\n          <Carousel\n            bindings={this.bindings}\n            currentPage={this.currentPage}\n            nextPage={() => this.nextPage()}\n            previousPage={() => this.previousPage()}\n            numberOfPages={this.numberOfPages}\n          >\n            {this.renderListOfRecommendations()}\n          </Carousel>\n        ) : (\n          this.renderListOfRecommendations()\n        )}\n      </Fragment>\n    );\n  }\n}\n"],"version":3}