import{ResultTemplatesHelpers as t}from"@coveo/headless";import{h as e}from"./p-dc3df5ce.js";import{e as n,f as o,a as r}from"./p-cbd58764.js";import{t as s}from"./p-acd1a1d3.js";import{i}from"./p-589f3bd5.js";function a(t){if(i(t)){return"section"}if(!o(t)){return"metadata"}if(r(t)&&t.tagName.toLowerCase()===s){return"table-column-definition"}return"other"}function l(t){return n(Array.from(t),(t=>a(t)))}class c{constructor({host:t,setError:e,validParents:n,allowEmpty:o=false}){this.matchConditions=[];this.gridCellLinkTarget="_self";this.host=t;this.validateTemplate(t,e,n,o)}validateTemplate(t,e,n,o=true){const r=n.map((t=>t.toUpperCase())).includes(t.parentElement?.nodeName||"");const s=t.nodeName.toLowerCase();if(!r){e(new Error(`The "${s}" component has to be the child of one of the following: ${n.map((t=>`"${t.toLowerCase()}"`)).join(", ")}.`));return}if(t.parentElement?.attributes.getNamedItem("display")?.value==="grid"){this.gridCellLinkTarget=t.parentElement?.attributes.getNamedItem("grid-cell-link-target")?.value}const i=t.querySelector("template:not([slot])");if(!i){e(new Error(`The "${s}" component has to contain a "template" element as a child.`));return}if(!o&&!i.innerHTML.trim()){e(new Error(`The "template" tag inside "${s}" cannot be empty.`));return}if(i.content.querySelector("script")){console.warn('Any "script" tags defined inside of "template" elements are not supported and will not be executed when the results are rendered.',t)}const{section:a,other:c}=l(i.content.childNodes);if(a?.length&&c?.length){console.warn("Result templates should only contain section elements or non-section elements. Future updates could unpredictably affect this result template.",t,{sectionNodes:a,otherNodes:c})}}getTemplate(t,e){if(e){return null}return{conditions:t.concat(this.matchConditions),content:m(this.host).content,linkContent:this.getLinkTemplateElement(this.host).content,priority:1}}renderIfError(t){if(t){return e("atomic-component-error",{element:this.host,error:t})}}getDefaultLinkTemplateElement(){const t=document.createElement("template");t.innerHTML=`<atomic-result-link>${this.gridCellLinkTarget?`<a slot="attributes" target="${this.gridCellLinkTarget}"></a>`:""}</atomic-result-link>`;return t}getLinkTemplateElement(t){return t.querySelector('template[slot="link"]')??this.getDefaultLinkTemplateElement()}}function m(t){return t.querySelector("template:not([slot])")}function u(e,n){const o=[];for(const n in e){o.push(t.fieldMustMatch(n,e[n]))}for(const e in n){o.push(t.fieldMustNotMatch(e,n[e]))}return o}function f(e,n){const o=[];if(e){const n=e.split(",");o.push(t.fieldsMustBeDefined(n))}if(n){const e=n.split(",");o.push(t.fieldsMustNotBeDefined(e))}return o}export{c as R,f as a,u as m};
//# sourceMappingURL=p-3607c634.js.map