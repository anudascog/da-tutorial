{"version":3,"names":["atomicInsightSmartSnippetSuggestionsCss","AtomicInsightSmartSnippetSuggestionsStyle0","AtomicInsightSmartSnippetSuggestions","this","headingLevel","initialize","id","randomID","smartSnippetQuestionsList","buildInsightSmartSnippetQuestionsList","bindings","engine","render","console","log","smartSnippetQuestionsListState","questions","length","h","Hidden","SmartSnippetSuggestionsWrapper","i18n","map","relatedQuestion","i","renderRelatedQuestion","index","SmartSnippetSuggestionsQuestionWrapper","expanded","key","questionAnswerId","SmartSnippetSuggestionsQuestion","ariaControls","onClick","toggleQuestion","question","icon","ArrowDown","ArrowRight","part","getQuestionPart","class","renderAnswer","SmartSnippetSuggestionsAnswerAndSourceWrapper","exportparts","htmlContent","answer","innerStyle","style","onSelectInlineLink","e","selectInlineLink","detail","onBeginDelayedSelectInlineLink","beginDelayedSelectInlineLink","onCancelPendingSelectInlineLink","cancelPendingSelectInlineLink","source","renderSource","SmartSnippetSuggestionsFooter","anchorAttributes","getAttributesFromLinkSlot","host","onBeginDelayedSelectSource","beginDelayedSelectSource","onCancelPendingSelectSource","cancelPendingSelectSource","onSelectSource","selectSource","styleTag","querySelector","content","snippetStyle","innerHTML","collapse","expand","__decorate","InitializeBindings","BindStateToController"],"sources":["src/components/insight/smart-snippets/atomic-insight-smart-snippet-suggestions/atomic-insight-smart-snippet-suggestions.pcss?tag=atomic-insight-smart-snippet-suggestions&encapsulation=shadow","src/components/insight/smart-snippets/atomic-insight-smart-snippet-suggestions/atomic-insight-smart-snippet-suggestions.tsx"],"sourcesContent":["@import '../../../common/smart-snippets/atomic-smart-snippet-suggestions/atomic-smart-snippet-suggestions.pcss';\n","import {getAttributesFromLinkSlot} from '@/src/components/common/item-link/attributes-slot';\nimport {Hidden} from '@/src/components/common/stencil-hidden';\nimport {randomID} from '@/src/utils/utils';\nimport {\n  buildSmartSnippetQuestionsList as buildInsightSmartSnippetQuestionsList,\n  SmartSnippetQuestionsList as InsightSmartSnippetQuestionsList,\n  SmartSnippetQuestionsListState as InsightSmartSnippetQuestionsListState,\n  Result,\n  SmartSnippetRelatedQuestion,\n} from '@coveo/headless/insight';\nimport {Component, Prop, State, Element, h} from '@stencil/core';\nimport ArrowDown from '../../../../images/arrow-down.svg';\nimport ArrowRight from '../../../../images/arrow-right.svg';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n  BindStateToController,\n} from '../../../../utils/initialization-utils';\nimport {\n  getQuestionPart,\n  SmartSnippetSuggestionsAnswerAndSourceWrapper,\n  SmartSnippetSuggestionsFooter,\n  SmartSnippetSuggestionsQuestion,\n  SmartSnippetSuggestionsQuestionWrapper,\n  SmartSnippetSuggestionsWrapper,\n} from '../../../common/smart-snippets/atomic-smart-snippet-suggestions/smart-snippet-suggestions-common';\nimport {InsightBindings} from '../../atomic-insight-interface/atomic-insight-interface';\n\n/**\n * @internal\n */\n@Component({\n  tag: 'atomic-insight-smart-snippet-suggestions',\n  styleUrl: 'atomic-insight-smart-snippet-suggestions.pcss',\n  shadow: true,\n})\nexport class AtomicInsightSmartSnippetSuggestions\n  implements InitializableComponent<InsightBindings>\n{\n  @InitializeBindings() public bindings!: InsightBindings;\n  public smartSnippetQuestionsList!: InsightSmartSnippetQuestionsList;\n  @BindStateToController('smartSnippetQuestionsList')\n  @State()\n  public smartSnippetQuestionsListState!: InsightSmartSnippetQuestionsListState;\n  public error!: Error;\n  @Element() public host!: HTMLElement;\n\n  /**\n   * The [heading level](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements) to use for the \"People also ask\" heading over the snippets, from 1 to 5.\n   */\n  @Prop({reflect: true}) public headingLevel = 0;\n\n  /**\n   * Sets the style of the snippets.\n   *\n   * Example:\n   * ```ts\n   * smartSnippet.snippetStyle = `\n   *   b {\n   *     color: blue;\n   *   }\n   * `;\n   * ```\n   */\n  @Prop() snippetStyle?: string;\n\n  private id!: string;\n\n  public initialize() {\n    this.id ||= randomID('atomic-smart-snippet-suggestions-');\n    this.smartSnippetQuestionsList = buildInsightSmartSnippetQuestionsList(\n      this.bindings.engine\n    );\n  }\n\n  public render() {\n    console.log(this.smartSnippetQuestionsListState);\n    if (!this.smartSnippetQuestionsListState.questions.length) {\n      return <Hidden></Hidden>;\n    }\n\n    return (\n      <SmartSnippetSuggestionsWrapper\n        headingLevel={this.headingLevel}\n        i18n={this.bindings.i18n}\n      >\n        {this.smartSnippetQuestionsListState.questions.map(\n          (relatedQuestion, i) => this.renderRelatedQuestion(relatedQuestion, i)\n        )}\n      </SmartSnippetSuggestionsWrapper>\n    );\n  }\n\n  private renderRelatedQuestion(\n    relatedQuestion: SmartSnippetRelatedQuestion,\n    index: number\n  ) {\n    return (\n      <SmartSnippetSuggestionsQuestionWrapper\n        expanded={relatedQuestion.expanded}\n        key={relatedQuestion.questionAnswerId}\n      >\n        <SmartSnippetSuggestionsQuestion\n          ariaControls={`${this.id}-${index}`}\n          expanded={relatedQuestion.expanded}\n          headingLevel={this.headingLevel}\n          onClick={() => this.toggleQuestion(relatedQuestion)}\n          question={relatedQuestion.question}\n        >\n          <atomic-icon\n            icon={relatedQuestion.expanded ? ArrowDown : ArrowRight}\n            part={getQuestionPart('icon', relatedQuestion.expanded)}\n            class=\"mr-3 w-2.5 stroke-[1.25]\"\n          ></atomic-icon>\n        </SmartSnippetSuggestionsQuestion>\n        {relatedQuestion.expanded && this.renderAnswer(relatedQuestion, index)}\n      </SmartSnippetSuggestionsQuestionWrapper>\n    );\n  }\n\n  private renderAnswer(\n    relatedQuestion: SmartSnippetRelatedQuestion,\n    index: number\n  ) {\n    return (\n      <SmartSnippetSuggestionsAnswerAndSourceWrapper\n        expanded={relatedQuestion.expanded}\n        id={`${this.id}-${index}`}\n      >\n        <atomic-smart-snippet-answer\n          exportparts=\"answer\"\n          htmlContent={relatedQuestion.answer}\n          innerStyle={this.style}\n          onSelectInlineLink={(e) =>\n            this.smartSnippetQuestionsList.selectInlineLink(\n              relatedQuestion.questionAnswerId,\n              e.detail\n            )\n          }\n          onBeginDelayedSelectInlineLink={(e) =>\n            this.smartSnippetQuestionsList.beginDelayedSelectInlineLink(\n              relatedQuestion.questionAnswerId,\n              e.detail\n            )\n          }\n          onCancelPendingSelectInlineLink={(e) =>\n            this.smartSnippetQuestionsList.cancelPendingSelectInlineLink(\n              relatedQuestion.questionAnswerId,\n              e.detail\n            )\n          }\n        ></atomic-smart-snippet-answer>\n        {relatedQuestion.source &&\n          this.renderSource(\n            relatedQuestion.questionAnswerId,\n            relatedQuestion.source\n          )}\n      </SmartSnippetSuggestionsAnswerAndSourceWrapper>\n    );\n  }\n\n  private renderSource(questionAnswerId: string, source: Result) {\n    return (\n      <SmartSnippetSuggestionsFooter i18n={this.bindings.i18n}>\n        <atomic-smart-snippet-source\n          anchorAttributes={getAttributesFromLinkSlot(\n            this.host,\n            'source-anchor-attributes'\n          )}\n          onBeginDelayedSelectSource={() =>\n            this.smartSnippetQuestionsList.beginDelayedSelectSource(\n              questionAnswerId\n            )\n          }\n          onCancelPendingSelectSource={() =>\n            this.smartSnippetQuestionsList.cancelPendingSelectSource(\n              questionAnswerId\n            )\n          }\n          onSelectSource={() =>\n            this.smartSnippetQuestionsList.selectSource(questionAnswerId)\n          }\n          source={source}\n        ></atomic-smart-snippet-source>\n      </SmartSnippetSuggestionsFooter>\n    );\n  }\n\n  private get style() {\n    const styleTag = this.host\n      .querySelector('template')\n      ?.content.querySelector('style');\n    if (!styleTag) {\n      return this.snippetStyle;\n    }\n    return styleTag.innerHTML;\n  }\n\n  private toggleQuestion(relatedQuestion: SmartSnippetRelatedQuestion) {\n    if (relatedQuestion.expanded) {\n      this.smartSnippetQuestionsList.collapse(relatedQuestion.questionAnswerId);\n    } else {\n      this.smartSnippetQuestionsList.expand(relatedQuestion.questionAnswerId);\n    }\n  }\n}\n"],"mappings":"4oBAAA,MAAMA,EAA0C,6s3DAChD,MAAAC,EAAeD,E,iXCmCFE,EAAoC,M,yBAcjBC,KAAAC,aAAe,E,gEAAA,E,4BAkBtC,UAAAC,GACLF,KAAKG,KAAOC,EAAS,qCACrBJ,KAAKK,0BAA4BC,EAC/BN,KAAKO,SAASC,O,CAIX,MAAAC,GACLC,QAAQC,IAAIX,KAAKY,gCACjB,IAAKZ,KAAKY,+BAA+BC,UAAUC,OAAQ,CACzD,OAAOC,EAACC,EAAM,K,CAGhB,OACED,EAACE,EAA8B,CAC7BhB,aAAcD,KAAKC,aACnBiB,KAAMlB,KAAKO,SAASW,MAEnBlB,KAAKY,+BAA+BC,UAAUM,KAC7C,CAACC,EAAiBC,IAAMrB,KAAKsB,sBAAsBF,EAAiBC,K,CAMpE,qBAAAC,CACNF,EACAG,GAEA,OACER,EAACS,EAAsC,CACrCC,SAAUL,EAAgBK,SAC1BC,IAAKN,EAAgBO,kBAErBZ,EAACa,EAA+B,CAC9BC,aAAc,GAAG7B,KAAKG,MAAMoB,IAC5BE,SAAUL,EAAgBK,SAC1BxB,aAAcD,KAAKC,aACnB6B,QAAS,IAAM9B,KAAK+B,eAAeX,GACnCY,SAAUZ,EAAgBY,UAE1BjB,EAAA,eACEkB,KAAMb,EAAgBK,SAAWS,EAAYC,EAC7CC,KAAMC,EAAgB,OAAQjB,EAAgBK,UAC9Ca,MAAM,8BAGTlB,EAAgBK,UAAYzB,KAAKuC,aAAanB,EAAiBG,G,CAK9D,YAAAgB,CACNnB,EACAG,GAEA,OACER,EAACyB,EAA6C,CAC5Cf,SAAUL,EAAgBK,SAC1BtB,GAAI,GAAGH,KAAKG,MAAMoB,KAElBR,EAAA,+BACE0B,YAAY,SACZC,YAAatB,EAAgBuB,OAC7BC,WAAY5C,KAAK6C,MACjBC,mBAAqBC,GACnB/C,KAAKK,0BAA0B2C,iBAC7B5B,EAAgBO,iBAChBoB,EAAEE,QAGNC,+BAAiCH,GAC/B/C,KAAKK,0BAA0B8C,6BAC7B/B,EAAgBO,iBAChBoB,EAAEE,QAGNG,gCAAkCL,GAChC/C,KAAKK,0BAA0BgD,8BAC7BjC,EAAgBO,iBAChBoB,EAAEE,UAIP7B,EAAgBkC,QACftD,KAAKuD,aACHnC,EAAgBO,iBAChBP,EAAgBkC,Q,CAMlB,YAAAC,CAAa5B,EAA0B2B,GAC7C,OACEvC,EAACyC,EAA6B,CAACtC,KAAMlB,KAAKO,SAASW,MACjDH,EAAA,+BACE0C,iBAAkBC,EAChB1D,KAAK2D,KACL,4BAEFC,2BAA4B,IAC1B5D,KAAKK,0BAA0BwD,yBAC7BlC,GAGJmC,4BAA6B,IAC3B9D,KAAKK,0BAA0B0D,0BAC7BpC,GAGJqC,eAAgB,IACdhE,KAAKK,0BAA0B4D,aAAatC,GAE9C2B,OAAQA,I,CAMhB,SAAYT,GACV,MAAMqB,EAAWlE,KAAK2D,KACnBQ,cAAc,aACbC,QAAQD,cAAc,SAC1B,IAAKD,EAAU,CACb,OAAOlE,KAAKqE,Y,CAEd,OAAOH,EAASI,S,CAGV,cAAAvC,CAAeX,GACrB,GAAIA,EAAgBK,SAAU,CAC5BzB,KAAKK,0BAA0BkE,SAASnD,EAAgBO,iB,KACnD,CACL3B,KAAKK,0BAA0BmE,OAAOpD,EAAgBO,iB,8BAnK7B8C,EAAA,CAA5BC,K,+BAIMD,EAAA,CAFNE,EAAsB,8B","ignoreList":[]}