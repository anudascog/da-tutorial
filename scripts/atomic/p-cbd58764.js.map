{"version":3,"names":["once","fn","result","args","apply","this","camelToKebab","value","replace","toLowerCase","kebabToCamel","x","toUpperCase","snakeToCamel","group","titleToKebab","randomID","prepend","length","randomStr","Math","random","toString","substring","parseXML","string","window","DOMParser","parseFromString","isElementNode","node","nodeType","Node","ELEMENT_NODE","isTextNode","TEXT_NODE","isVisualNode","HTMLStyleElement","textContent","trim","containsVisualElement","i","childNodes","child","item","elementHasAncestorTag","el","tagName","parentElement","sanitizeStyle","style","purifiedOuterHTML","DOMPurify","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","FORCE_BODY","wrapperEl","document","createElement","innerHTML","querySelector","getFocusedElement","rootElement","activeElement","shadowRoot","isFocusingOut","event","hasFocus","relatedTarget","currentTarget","contains","isInDocument","element","currentElement","parentNode","ShadowRoot","host","getParent","isAncestorOf","ancestor","HTMLElement","assignedSlot","parent","aggregate","values","getKey","reduce","aggregatedValues","key","push","spreadProperties","objects","returnObject","obj","Object","defineProperties","getOwnPropertyDescriptors","sortByDocumentPosition","a","b","compareDocumentPosition","DOCUMENT_POSITION_FOLLOWING","async","defer","Promise","resolve","setTimeout"],"sources":["src/utils/utils.ts"],"sourcesContent":["import DOMPurify from 'dompurify';\n\n/**\n * Returns a function that can be executed only once\n */\nexport function once<T extends unknown[]>(fn: (...args: T) => unknown) {\n  let result: unknown;\n  return function (this: unknown, ...args: T) {\n    if (fn) {\n      result = fn.apply(this, args);\n      fn = () => {};\n    }\n    return result;\n  };\n}\n\nexport function camelToKebab(value: string) {\n  return value.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g, '$1-$2').toLowerCase();\n}\n\nexport function kebabToCamel(value: string) {\n  return value.replace(/-./g, (x) => x[1].toUpperCase());\n}\n\nexport function snakeToCamel(value: string) {\n  return value\n    .toLowerCase()\n    .replace(/([_][a-z])/g, (group) => group.toUpperCase().replace('_', ''));\n}\n\nexport function titleToKebab(value: string) {\n  return value.replace(/\\s/g, '-').toLowerCase();\n}\n\nexport function randomID(prepend?: string, length = 5) {\n  const randomStr = Math.random()\n    .toString(36)\n    .substring(2, 2 + length);\n  if (!prepend) {\n    return randomStr;\n  }\n  return prepend + randomStr;\n}\n\nexport function getRandomArbitrary(min: number, max: number) {\n  return Math.random() * (max - min) + min;\n}\n\nexport function parseXML(string: string) {\n  return new window.DOMParser().parseFromString(string, 'text/xml');\n}\n\nexport function parseHTML(string: string) {\n  return new window.DOMParser().parseFromString(string, 'text/html');\n}\n\nexport function isElementNode(node: Node): node is Element {\n  return node.nodeType === Node.ELEMENT_NODE;\n}\n\nexport function isTextNode(node: Node): node is Text {\n  return node.nodeType === Node.TEXT_NODE;\n}\n\nexport function isVisualNode(node: Node) {\n  if (isElementNode(node)) {\n    return !(node instanceof HTMLStyleElement);\n  }\n  if (isTextNode(node)) {\n    return !!node.textContent?.trim();\n  }\n  return false;\n}\n\nexport function containsVisualElement(node: Node) {\n  for (let i = 0; i < node.childNodes.length; i++) {\n    const child = node.childNodes.item(i);\n    if (isVisualNode(child)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function elementHasAncestorTag(\n  el: HTMLElement,\n  tagName: string\n): boolean {\n  const parentElement = el.parentElement;\n  if (!parentElement) {\n    return false;\n  }\n  if (parentElement.tagName === tagName.toUpperCase()) {\n    return true;\n  }\n  return elementHasAncestorTag(parentElement, tagName);\n}\n\nexport function sanitizeStyle(style: string) {\n  const purifiedOuterHTML = DOMPurify.sanitize(`<style>${style}</style>`, {\n    ALLOWED_TAGS: ['style'],\n    ALLOWED_ATTR: [],\n    FORCE_BODY: true,\n  });\n  const wrapperEl = document.createElement('div');\n  // deepcode ignore ReactSetInnerHtml: sanitized by dompurify\n  wrapperEl.innerHTML = purifiedOuterHTML;\n  return wrapperEl.querySelector('style')?.innerHTML;\n}\n\nexport function getFocusedElement(\n  rootElement: Document | ShadowRoot = document\n): Element | null {\n  const activeElement = rootElement.activeElement;\n  if (activeElement?.shadowRoot) {\n    return getFocusedElement(activeElement.shadowRoot) ?? activeElement;\n  }\n  return activeElement;\n}\n\nexport function isFocusingOut(event: FocusEvent) {\n  return (\n    document.hasFocus() &&\n    (!(event.relatedTarget instanceof Node) ||\n      (event.currentTarget instanceof Node &&\n        !event.currentTarget.contains(event.relatedTarget)))\n  );\n}\n\n// https://terodox.tech/how-to-tell-if-an-element-is-in-the-dom-including-the-shadow-dom/\nexport function isInDocument(element: Node) {\n  let currentElement = element;\n  while (currentElement && currentElement.parentNode) {\n    if (currentElement.parentNode === document) {\n      return true;\n    } else if (currentElement.parentNode instanceof ShadowRoot) {\n      currentElement = currentElement.parentNode.host;\n    } else {\n      currentElement = currentElement.parentNode;\n    }\n  }\n  return false;\n}\n\nexport function isPropValuesEqual<ObjectWithProperties extends object>(\n  subject: ObjectWithProperties,\n  target: ObjectWithProperties,\n  propNames: (keyof ObjectWithProperties)[]\n) {\n  return propNames.every((propName) => subject[propName] === target[propName]);\n}\n\nexport function getParent(element: Element | ShadowRoot) {\n  if (element.parentNode) {\n    return element.parentNode as Element | ShadowRoot;\n  }\n  if (element instanceof ShadowRoot) {\n    return element.host;\n  }\n  return null;\n}\n\nexport function isAncestorOf(\n  ancestor: Element | ShadowRoot,\n  element: Element | ShadowRoot\n): boolean {\n  if (element === ancestor) {\n    return true;\n  }\n  if (\n    element instanceof HTMLElement &&\n    element.assignedSlot &&\n    isAncestorOf(ancestor, element.assignedSlot)\n  ) {\n    return true;\n  }\n  const parent = getParent(element);\n  return parent === null ? false : isAncestorOf(ancestor, parent);\n}\n\nexport function aggregate<V, K extends PropertyKey>(\n  values: readonly V[],\n  getKey: (value: V, index: number) => K\n): Record<K, V[] | undefined> {\n  return values.reduce(\n    (aggregatedValues, value, i) => {\n      const key = getKey(value, i);\n      if (!(key in aggregatedValues)) {\n        aggregatedValues[key] = [];\n      }\n      aggregatedValues[key]!.push(value);\n      return aggregatedValues;\n    },\n    <Record<K, V[] | undefined>>{}\n  );\n}\n\n/**\n * Similar as a classic spread, but preserve all characteristics of properties (e.g. getter/setter).\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#description\n * for an explanation why (spread & assign work similarly).\n * @param objects the objects to \"spread\" together\n * @returns the spread result\n */\nexport function spreadProperties<Output extends object = {}>(\n  ...objects: object[]\n) {\n  const returnObject = {};\n  for (const obj of objects) {\n    Object.defineProperties(\n      returnObject,\n      Object.getOwnPropertyDescriptors(obj)\n    );\n  }\n  return returnObject as Output;\n}\n\nexport const sortByDocumentPosition = (a: Node, b: Node): 1 | -1 =>\n  a.compareDocumentPosition(b) & Node.DOCUMENT_POSITION_FOLLOWING ? -1 : 1;\n\nexport async function defer() {\n  return new Promise<void>((resolve) => setTimeout(resolve, 10));\n}\n"],"mappings":"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","ignoreList":[]}