{"file":"atomic-commerce-products-per-page.entry.js","mappings":"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","names":[],"sources":["src/components/commerce/atomic-commerce-products-per-page/atomic-commerce-products-per-page.pcss?tag=atomic-commerce-products-per-page&encapsulation=shadow","src/components/commerce/atomic-commerce-products-per-page/atomic-commerce-products-per-page.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {\n  Pagination,\n  PaginationState,\n  buildSearch,\n  buildProductListing,\n  SearchSummaryState,\n  ProductListingSummaryState,\n  Summary,\n} from '@coveo/headless/commerce';\nimport {Component, Event, EventEmitter, h, Prop, State} from '@stencil/core';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../utils/initialization-utils';\nimport {randomID} from '../../../utils/utils';\nimport {createAppLoadedListener} from '../../common/interface/store';\nimport {Choices} from '../../common/items-per-page/choices';\nimport {\n  ChoiceIsNaNError,\n  InitialChoiceNotInChoicesError,\n} from '../../common/items-per-page/error';\nimport {Label} from '../../common/items-per-page/label';\nimport {\n  convertChoicesToNumbers,\n  validateInitialChoice,\n} from '../../common/items-per-page/validate';\nimport {PagerGuard} from '../../common/pager/stencil-pager-guard';\nimport {FieldsetGroup} from '../../common/stencil-fieldset-group';\nimport type {CommerceBindings as Bindings} from '../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * The `atomic-commerce-products-per-page` component determines how many products to display per page.\n *\n * @part label - The \"Products per page\" label.\n * @part buttons - The list of buttons.\n * @part button - The individual products per page buttons.\n * @part active-button - The active products per page button.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-products-per-page',\n  styleUrl: 'atomic-commerce-products-per-page.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceProductsPerPage\n  implements InitializableComponent<Bindings>\n{\n  @InitializeBindings() public bindings!: Bindings;\n\n  public pagination!: Pagination;\n  @BindStateToController('pagination')\n  @State()\n  private paginationState!: PaginationState;\n\n  public summary!: Summary;\n  @BindStateToController('summary')\n  @State()\n  private summaryState!: SearchSummaryState | ProductListingSummaryState;\n\n  @State() public error!: Error;\n  @State() private isAppLoaded = false;\n\n  private choices!: number[];\n  private readonly radioGroupName = randomID(\n    'atomic-commerce-products-per-page-'\n  );\n\n  /**\n   * A list of choices for the number of products to display per page, separated by commas.\n   */\n  @Prop({reflect: true}) choicesDisplayed = '10,25,50,100';\n  /**\n   * The initial selection for the number of product per page. This should be part of the `choicesDisplayed` option. By default, this is set to the first value in `choicesDisplayed`.\n   * @type {number}\n   */\n  @Prop({mutable: true, reflect: true}) initialChoice?: number;\n\n  @Event({\n    eventName: 'atomic/scrollToTop',\n  })\n  private scrollToTopEvent!: EventEmitter;\n\n  public initialize() {\n    try {\n      this.choices = convertChoicesToNumbers(this.choicesDisplayed);\n      this.initialChoice = this.initialChoice ?? this.choices[0];\n      validateInitialChoice(this.initialChoice, this.choices);\n    } catch (error) {\n      if (\n        error instanceof ChoiceIsNaNError ||\n        error instanceof InitialChoiceNotInChoicesError\n      ) {\n        this.bindings.engine.logger.error(error.message, this);\n        throw error;\n      }\n    }\n\n    const controller =\n      this.bindings.interfaceElement.type === 'search'\n        ? buildSearch(this.bindings.engine)\n        : buildProductListing(this.bindings.engine);\n\n    this.summary = controller.summary();\n    this.pagination = controller.pagination(\n      this.initialChoice ? {options: {pageSize: this.initialChoice}} : {}\n    );\n    createAppLoadedListener(this.bindings.store, (isAppLoaded) => {\n      this.isAppLoaded = isAppLoaded;\n    });\n  }\n\n  private get label() {\n    return this.bindings.i18n.t('products-per-page');\n  }\n\n  public render() {\n    return (\n      <PagerGuard\n        hasError={this.summaryState.hasError}\n        hasItems={this.summaryState.hasProducts}\n        isAppLoaded={this.isAppLoaded}\n      >\n        <div class=\"flex items-center\">\n          <Label>{this.label}</Label>\n          <FieldsetGroup label={this.label}>\n            <Choices\n              label={this.label}\n              groupName={this.radioGroupName}\n              pageSize={this.paginationState.pageSize}\n              choices={this.choices}\n              lang={this.bindings.i18n.language}\n              scrollToTopEvent={this.scrollToTopEvent.emit}\n              setItemSize={this.pagination.setPageSize}\n              focusOnFirstResultAfterNextSearch={() =>\n                this.bindings.store.state.resultList?.focusOnFirstResultAfterNextSearch()\n              }\n              focusOnNextNewResult={() =>\n                this.bindings.store.state.resultList?.focusOnNextNewResult()\n              }\n            ></Choices>\n          </FieldsetGroup>\n        </div>\n      </PagerGuard>\n    );\n  }\n}\n"],"version":3}