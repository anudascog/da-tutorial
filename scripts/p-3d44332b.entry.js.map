{"version":3,"names":["atomicProductCss","AtomicProductStyle0","AtomicProduct","this","linkContent","DocumentFragment","display","density","imageSize","classes","executedRenderingFunctionOnce","resolveProduct","event","preventDefault","stopPropagation","detail","product","resolveInteractiveProduct","interactiveProduct","resolveStopPropagation","resolveProductDisplayConfig","connectedCallback","layout","ItemLayout","content","children","isCustomRenderFunctionMode","renderingFunction","undefined","getContentHTML","parentNodeToString","getLinkHTML","HTMLElement","handleClick","host","shadowRoot","querySelector","click","shouldExecuteRenderFunction","productRootRef","render","h","Host","class","resultComponentClass","ref","linkContainerRef","getClasses","concat","join","innerHTML","componentDidLoad","loadingFlag","store","unsetLoadingFlag","componentDidRender","customRenderOutputAsString","className","classList","add"],"sources":["src/components/commerce/atomic-product/atomic-product.pcss?tag=atomic-product&encapsulation=shadow","src/components/commerce/atomic-product/atomic-product.tsx"],"sourcesContent":["@import '../../common/template-system/template-system.pcss';\n\n:host {\n  @apply atomic-template-system;\n  @apply relative;\n\n  .with-sections {\n    &.image-icon {\n      atomic-product-image::part(previous-button),\n      atomic-product-image::part(next-button),\n      atomic-product-image::part(indicator) {\n        display: none;\n      }\n    }\n    &.display-grid {\n      &.image-large,\n      &.image-small,\n      &.image-icon,\n      &.image-none {\n        atomic-product-section-name {\n          min-height: calc(var(--line-height) * 2);\n          @apply line-clamp-2;\n        }\n      }\n\n      @media (width >= theme(--breakpoint-desktop)) {\n        &.image-large {\n          atomic-product-section-children .product-child {\n            @apply aspect-square-[auto];\n            width: 16.65%;\n          }\n        }\n\n        &.image-small {\n          atomic-product-section-children .product-child {\n            @apply aspect-square-[auto];\n            width: 16.65%;\n          }\n        }\n\n        &.image-icon,\n        &.image-none {\n          atomic-product-section-children .product-child {\n            width: 2rem;\n            height: 2rem;\n          }\n        }\n      }\n\n      @media not all and (width >= theme(--breakpoint-desktop)) {\n        &.image-large {\n          atomic-product-section-children .product-child {\n            @apply aspect-square-[auto];\n            width: 16.65%;\n          }\n        }\n        &.image-small {\n          atomic-product-section-children .product-child {\n            @apply aspect-square-[auto];\n            width: 16.65%;\n            max-width: 4.75rem;\n          }\n        }\n\n        &.image-icon,\n        &.image-none {\n          atomic-product-section-children .product-child {\n            width: 2rem;\n            height: 2rem;\n          }\n        }\n      }\n\n      &.density-comfortable {\n        &.image-icon,\n        &.image-none,\n        &.image-small,\n        &.image-large {\n          & atomic-product-section-description {\n            margin-top: 1.25rem;\n          }\n        }\n      }\n      &.density-normal {\n        &.image-icon,\n        &.image-none,\n        &.image-small,\n        &.image-large {\n          & atomic-product-section-description {\n            margin-top: 0.75rem;\n          }\n        }\n      }\n\n      &.density-compact {\n        &.image-icon,\n        &.image-none,\n        &.image-small,\n        &.image-large {\n          & atomic-product-section-description {\n            margin-top: 0.25rem;\n          }\n        }\n      }\n    }\n\n    &.display-list {\n      @media (width >= theme(--breakpoint-desktop)) {\n        &.image-large.density-comfortable,\n        &.image-large.density-normal {\n          atomic-product-section-children .product-child {\n            width: 6.75rem;\n            height: 6.75rem;\n          }\n        }\n\n        &.image-small,\n        &.image-large.density-compact,\n        &.image-icon {\n          atomic-product-section-children .product-child {\n            width: 2rem;\n            height: 2rem;\n          }\n        }\n      }\n\n      @media not all and (width >= theme(--breakpoint-desktop)) {\n        &.image-large {\n          atomic-product-section-children .product-child {\n            @apply aspect-square-[auto];\n            width: 16.65%;\n          }\n        }\n\n        &.image-small,\n        &.image-icon {\n          atomic-product-section-children .product-child {\n            width: 2rem;\n            height: 2rem;\n          }\n        }\n      }\n    }\n  }\n}\n","import {Product, InteractiveProduct} from '@coveo/headless/commerce';\nimport {Component, h, Prop, Element, Listen, Host} from '@stencil/core';\nimport {parentNodeToString} from '../../../utils/dom-utils';\nimport {DisplayConfig} from '../../common/item-list/item-decorators';\nimport {\n  ItemRenderingFunction,\n  resultComponentClass,\n} from '../../common/item-list/stencil-item-list-common';\nimport {\n  ItemLayout,\n  ItemDisplayDensity,\n  ItemDisplayImageSize,\n  ItemDisplayLayout,\n} from '../../common/layout/display-options';\nimport {CommerceStore} from '../atomic-commerce-interface/store';\nimport {CommerceRecommendationStore} from '../atomic-commerce-recommendation-interface/store';\nimport {\n  InteractiveProductContextEvent,\n  ProductContextEvent,\n} from '../product-template-components/product-template-decorators';\n\n/**\n * The `atomic-product` component is used internally by the `atomic-commerce-product-list` component.\n * @alpha\n */\n@Component({\n  tag: 'atomic-product',\n  styleUrl: 'atomic-product.pcss',\n  shadow: true,\n})\nexport class AtomicProduct {\n  private layout!: ItemLayout;\n\n  @Element() host!: HTMLElement;\n\n  /**\n   * Whether an atomic-product-link inside atomic-product should stop click event propagation.\n   */\n  @Prop() stopPropagation?: boolean;\n\n  /**\n   * The product item.\n   */\n  @Prop() product!: Product;\n\n  /**\n   * The InteractiveProduct item.\n   * @alpha\n   */\n  @Prop() interactiveProduct!: InteractiveProduct;\n\n  /**\n   * Global Atomic state.\n   * @alpha\n   */\n  @Prop() store?: CommerceStore | CommerceRecommendationStore;\n\n  /**\n   * The product content to display.\n   */\n  @Prop() content?: ParentNode;\n\n  /**\n   * The product link to use when the product is clicked in a grid layout.\n   *\n   * @default - An `atomic-result-link` without any customization.\n   */\n  @Prop() linkContent: ParentNode = new DocumentFragment();\n\n  /**\n   * How products should be displayed.\n   */\n  @Prop() display: ItemDisplayLayout = 'list';\n\n  /**\n   * How large or small products should be.\n   */\n  @Prop() density: ItemDisplayDensity = 'normal';\n\n  /**\n   * The size of the visual section in product list items.\n   *\n   * This is overwritten by the image size defined in the product content, if it exists.\n   */\n  @Prop() imageSize: ItemDisplayImageSize = 'icon';\n\n  /**\n   * The classes to add to the product element.\n   */\n  @Prop() classes = '';\n\n  /**\n   * @alpha\n   */\n  @Prop() loadingFlag?: string;\n\n  /**\n   * Internal function used in advanced setups, which lets you bypass the standard HTML template system.\n   * Particularly useful for Atomic React\n   *\n   * @alpha\n   */\n  @Prop() renderingFunction: ItemRenderingFunction;\n\n  private productRootRef?: HTMLElement;\n  private linkContainerRef?: HTMLElement;\n  private executedRenderingFunctionOnce = false;\n\n  @Listen('atomic/resolveResult')\n  public resolveProduct(event: ProductContextEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail(this.product);\n  }\n\n  @Listen('atomic/resolveInteractiveResult')\n  public resolveInteractiveProduct(event: InteractiveProductContextEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.interactiveProduct) {\n      event.detail(this.interactiveProduct);\n    }\n  }\n\n  @Listen('atomic/resolveStopPropagation')\n  public resolveStopPropagation(event: CustomEvent) {\n    event.detail(this.stopPropagation);\n  }\n\n  @Listen('atomic/resolveResultDisplayConfig')\n  public resolveProductDisplayConfig(\n    event: ProductContextEvent<DisplayConfig>\n  ) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail({\n      density: this.density,\n      imageSize: this.imageSize!,\n    });\n  }\n\n  public connectedCallback() {\n    this.layout = new ItemLayout(\n      this.content!.children,\n      this.display,\n      this.density,\n      this.imageSize\n    );\n  }\n\n  private get isCustomRenderFunctionMode() {\n    return this.renderingFunction !== undefined;\n  }\n\n  private getContentHTML() {\n    return parentNodeToString(this.content!);\n  }\n\n  private getLinkHTML() {\n    return parentNodeToString(this.linkContent ?? new HTMLElement());\n  }\n\n  @Listen('click')\n  public handleClick(event: MouseEvent) {\n    if (this.stopPropagation) {\n      event.stopPropagation();\n    }\n    this.host\n      .shadowRoot!.querySelector<HTMLAnchorElement>(\n        '.link-container > atomic-product-link a:not([slot])'\n      )\n      ?.click();\n  }\n\n  private shouldExecuteRenderFunction() {\n    return (\n      this.isCustomRenderFunctionMode &&\n      this.productRootRef &&\n      !this.executedRenderingFunctionOnce\n    );\n  }\n\n  public render() {\n    if (this.isCustomRenderFunctionMode) {\n      return (\n        <Host class={resultComponentClass}>\n          <div\n            class=\"result-root\"\n            ref={(ref) => (this.productRootRef = ref)}\n          ></div>\n          <div\n            class=\"link-container\"\n            ref={(ref) => (this.linkContainerRef = ref)}\n          ></div>\n        </Host>\n      );\n    }\n    return (\n      <Host class={resultComponentClass}>\n        <div\n          class={`result-root ${this.layout\n            .getClasses()\n            .concat(this.classes)\n            .join(' ')}`}\n          innerHTML={this.getContentHTML()}\n        ></div>\n        <div class=\"link-container\" innerHTML={this.getLinkHTML()}></div>\n      </Host>\n    );\n  }\n\n  public componentDidLoad() {\n    if (this.loadingFlag && this.store) {\n      this.store.unsetLoadingFlag(this.loadingFlag);\n    }\n  }\n\n  public componentDidRender() {\n    if (this.shouldExecuteRenderFunction()) {\n      const customRenderOutputAsString = this.renderingFunction!(\n        this.product,\n        this.productRootRef!,\n        this.linkContainerRef!\n      );\n\n      this.productRootRef!.className += ` ${this.layout\n        .getClasses(customRenderOutputAsString)\n        .concat(this.classes)\n        .join(' ')}`;\n\n      this.executedRenderingFunctionOnce = true;\n    }\n    this.host.classList.add('hydrated');\n  }\n}\n"],"mappings":"6UAAA,MAAMA,EAAmB,g9xcACzB,MAAAC,EAAeD,E,MC6BFE,EAAa,M,yBAqChBC,KAAAC,YAA0B,IAAIC,iBAK9BF,KAAAG,QAA6B,OAK7BH,KAAAI,QAA8B,SAO9BJ,KAAAK,UAAkC,OAKlCL,KAAAM,QAAU,GAiBVN,KAAAO,8BAAgC,M,qJAvCN,IAAIL,iB,aAKD,O,aAKC,S,eAOI,O,aAKxB,G,4DAoBX,cAAAM,CAAeC,GACpBA,EAAMC,iBACND,EAAME,kBACNF,EAAMG,OAAOZ,KAAKa,Q,CAIb,yBAAAC,CAA0BL,GAC/BA,EAAMC,iBACND,EAAME,kBACN,GAAIX,KAAKe,mBAAoB,CAC3BN,EAAMG,OAAOZ,KAAKe,mB,EAKf,sBAAAC,CAAuBP,GAC5BA,EAAMG,OAAOZ,KAAKW,gB,CAIb,2BAAAM,CACLR,GAEAA,EAAMC,iBACND,EAAME,kBACNF,EAAMG,OAAO,CACXR,QAASJ,KAAKI,QACdC,UAAWL,KAAKK,W,CAIb,iBAAAa,GACLlB,KAAKmB,OAAS,IAAIC,EAChBpB,KAAKqB,QAASC,SACdtB,KAAKG,QACLH,KAAKI,QACLJ,KAAKK,U,CAIT,8BAAYkB,GACV,OAAOvB,KAAKwB,oBAAsBC,S,CAG5B,cAAAC,GACN,OAAOC,EAAmB3B,KAAKqB,Q,CAGzB,WAAAO,GACN,OAAOD,EAAmB3B,KAAKC,aAAe,IAAI4B,Y,CAI7C,WAAAC,CAAYrB,GACjB,GAAIT,KAAKW,gBAAiB,CACxBF,EAAME,iB,CAERX,KAAK+B,KACFC,WAAYC,cACX,wDAEAC,O,CAGE,2BAAAC,GACN,OACEnC,KAAKuB,4BACLvB,KAAKoC,iBACJpC,KAAKO,6B,CAIH,MAAA8B,GACL,GAAIrC,KAAKuB,2BAA4B,CACnC,OACEe,EAACC,EAAI,CAACC,MAAOC,GACXH,EAAA,OACEE,MAAM,cACNE,IAAMA,GAAS1C,KAAKoC,eAAiBM,IAEvCJ,EAAA,OACEE,MAAM,iBACNE,IAAMA,GAAS1C,KAAK2C,iBAAmBD,I,CAK/C,OACEJ,EAACC,EAAI,CAACC,MAAOC,GACXH,EAAA,OACEE,MAAO,eAAexC,KAAKmB,OACxByB,aACAC,OAAO7C,KAAKM,SACZwC,KAAK,OACRC,UAAW/C,KAAK0B,mBAElBY,EAAA,OAAKE,MAAM,iBAAiBO,UAAW/C,KAAK4B,gB,CAK3C,gBAAAoB,GACL,GAAIhD,KAAKiD,aAAejD,KAAKkD,MAAO,CAClClD,KAAKkD,MAAMC,iBAAiBnD,KAAKiD,Y,EAI9B,kBAAAG,GACL,GAAIpD,KAAKmC,8BAA+B,CACtC,MAAMkB,EAA6BrD,KAAKwB,kBACtCxB,KAAKa,QACLb,KAAKoC,eACLpC,KAAK2C,kBAGP3C,KAAKoC,eAAgBkB,WAAa,IAAItD,KAAKmB,OACxCyB,WAAWS,GACXR,OAAO7C,KAAKM,SACZwC,KAAK,OAER9C,KAAKO,8BAAgC,I,CAEvCP,KAAK+B,KAAKwB,UAAUC,IAAI,W","ignoreList":[]}