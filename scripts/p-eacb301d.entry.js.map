{"version":3,"names":["atomicCommerceQueryErrorCss","AtomicCommerceQueryErrorStyle0","AtomicCommerceQueryError","this","showMoreInfo","initialize","bindings","interfaceElement","type","searchOrListing","buildProductListing","engine","buildSearch","render","error","searchOrListingState","i18n","configuration","organizationId","environment","commerce","url","apiBaseUrl","getCommerceApiBaseUrl","hasError","isNullOrUndefined","ariaMessage","getAriaMessageFromErrorType","h","QueryErrorGuard","key","QueryErrorContainer","QueryErrorIcon","errorType","QueryErrorTitle","QueryErrorDescription","QueryErrorShowMore","link","QueryErrorLink","onShowMore","QueryErrorDetails","show","__decorate","InitializeBindings","BindStateToController","AriaLiveRegion"],"sources":["src/components/commerce/atomic-commerce-query-error/atomic-commerce-query-error.pcss?tag=atomic-commerce-query-error&encapsulation=shadow","src/components/commerce/atomic-commerce-query-error/atomic-commerce-query-error.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {isNullOrUndefined} from '@coveo/bueno';\nimport {\n  Search,\n  ProductListing,\n  SearchState,\n  ProductListingState,\n  buildProductListing,\n  buildSearch,\n  getCommerceApiBaseUrl,\n} from '@coveo/headless/commerce';\nimport {Component, h, State} from '@stencil/core';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../utils/initialization-utils';\nimport {AriaLiveRegion} from '../../../utils/stencil-accessibility-utils';\nimport {QueryErrorContainer} from '../../common/query-error/container';\nimport {QueryErrorDescription} from '../../common/query-error/description';\nimport {QueryErrorDetails} from '../../common/query-error/details';\nimport {QueryErrorGuard} from '../../common/query-error/guard';\nimport {QueryErrorIcon} from '../../common/query-error/icon';\nimport {QueryErrorLink} from '../../common/query-error/link';\nimport {QueryErrorShowMore} from '../../common/query-error/show-more';\nimport {QueryErrorTitle} from '../../common/query-error/title';\nimport {getAriaMessageFromErrorType} from '../../common/query-error/utils';\nimport {CommerceBindings} from '../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * The `atomic-commerce-query-error` component handles fatal errors when performing a query on the Commerce API. When the error is known, it displays a link to relevant documentation for debugging purposes. When the error is unknown, it displays a small text area with the JSON content of the error.\n *\n * @part icon - The SVG related to the error.\n * @part title - The title of the error.\n * @part description - A description of the error.\n * @part doc-link - A link to the relevant documentation.\n * @part more-info-btn - A button to request additional error information.\n * @part error-info - Additional error information.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-query-error',\n  styleUrl: 'atomic-commerce-query-error.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceQueryError\n  implements InitializableComponent<CommerceBindings>\n{\n  @InitializeBindings() public bindings!: CommerceBindings;\n  public searchOrListing!: Search | ProductListing;\n\n  @BindStateToController('searchOrListing')\n  @State()\n  private searchOrListingState!: SearchState | ProductListingState;\n  @State() public error!: Error;\n  @State() showMoreInfo = false;\n\n  @AriaLiveRegion('commerce-query-error')\n  protected ariaMessage!: string;\n\n  public initialize() {\n    if (this.bindings.interfaceElement.type === 'product-listing') {\n      this.searchOrListing = buildProductListing(this.bindings.engine);\n    } else {\n      this.searchOrListing = buildSearch(this.bindings.engine);\n    }\n  }\n\n  public render() {\n    const {error} = this.searchOrListingState;\n\n    const {\n      bindings: {\n        i18n,\n        engine: {\n          configuration: {organizationId, environment, commerce},\n        },\n      },\n    } = this;\n\n    const url =\n      commerce.apiBaseUrl ?? getCommerceApiBaseUrl(organizationId, environment);\n\n    const hasError = !isNullOrUndefined(error);\n    if (hasError) {\n      this.ariaMessage = getAriaMessageFromErrorType(\n        i18n,\n        organizationId,\n        url,\n        error?.type\n      );\n    }\n    return (\n      <QueryErrorGuard hasError={hasError}>\n        <QueryErrorContainer>\n          <QueryErrorIcon errorType={error?.type} />\n          <QueryErrorTitle\n            errorType={error?.type}\n            i18n={i18n}\n            organizationId={organizationId}\n          />\n          <QueryErrorDescription\n            i18n={i18n}\n            organizationId={organizationId}\n            url={url}\n            errorType={error?.type}\n          />\n          <QueryErrorShowMore\n            link={<QueryErrorLink i18n={i18n} errorType={error?.type} />}\n            onShowMore={() => (this.showMoreInfo = !this.showMoreInfo)}\n            i18n={i18n}\n          />\n          <QueryErrorDetails error={error} show={this.showMoreInfo} />\n        </QueryErrorContainer>\n      </QueryErrorGuard>\n    );\n  }\n}\n"],"mappings":"kmBAAA,MAAMA,EAA8B,k60DACpC,MAAAC,EAAeD,E,iXC4CFE,EAAwB,M,yBAU1BC,KAAAC,aAAe,M,2EAAA,K,CAKjB,UAAAC,GACL,GAAIF,KAAKG,SAASC,iBAAiBC,OAAS,kBAAmB,CAC7DL,KAAKM,gBAAkBC,EAAoBP,KAAKG,SAASK,O,KACpD,CACLR,KAAKM,gBAAkBG,EAAYT,KAAKG,SAASK,O,EAI9C,MAAAE,GACL,MAAMC,MAACA,GAASX,KAAKY,qBAErB,MACET,UAAUU,KACRA,EACAL,QACEM,eAAeC,eAACA,EAAcC,YAAEA,EAAWC,SAAEA,MAG/CjB,KAEJ,MAAMkB,EACJD,EAASE,YAAcC,EAAsBL,EAAgBC,GAE/D,MAAMK,GAAYC,EAAkBX,GACpC,GAAIU,EAAU,CACZrB,KAAKuB,YAAcC,EACjBX,EACAE,EACAG,EACAP,GAAON,K,CAGX,OACEoB,EAACC,EAAe,CAAAC,IAAA,2CAACN,SAAUA,GACzBI,EAACG,EAAmB,CAAAD,IAAA,4CAClBF,EAACI,EAAc,CAAAF,IAAA,2CAACG,UAAWnB,GAAON,OAClCoB,EAACM,EAAe,CAAAJ,IAAA,2CACdG,UAAWnB,GAAON,KAClBQ,KAAMA,EACNE,eAAgBA,IAElBU,EAACO,EAAqB,CAAAL,IAAA,2CACpBd,KAAMA,EACNE,eAAgBA,EAChBG,IAAKA,EACLY,UAAWnB,GAAON,OAEpBoB,EAACQ,EAAkB,CAAAN,IAAA,2CACjBO,KAAMT,EAACU,EAAc,CAACtB,KAAMA,EAAMiB,UAAWnB,GAAON,OACpD+B,WAAY,IAAOpC,KAAKC,cAAgBD,KAAKC,aAC7CY,KAAMA,IAERY,EAACY,EAAiB,CAAAV,IAAA,2CAAChB,MAAOA,EAAO2B,KAAMtC,KAAKC,gB,GAhEvBsC,EAAA,CAA5BC,K,+BAKOD,EAAA,CAFPE,EAAsB,oB,2CAObF,EAAA,CADTG,EAAe,yB","ignoreList":[]}