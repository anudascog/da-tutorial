{"file":"atomic-insight-user-actions-session.atomic-insight-user-actions-timeline.entry.cjs.js","mappings":"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","names":["SearchIcon","QuickviewIcon","parseTimestampToDateDetails","h","Button","__decorate","InitializeBindings","buildInsightUserActions","NoItemsContainer","MagnifyingGlass","BindStateToController"],"sources":["src/components/insight/user-actions/atomic-insight-user-actions-session/user-action.tsx","src/components/insight/user-actions/atomic-insight-user-actions-session/atomic-insight-user-actions-session.pcss?tag=atomic-insight-user-actions-session&encapsulation=shadow","src/components/insight/user-actions/atomic-insight-user-actions-session/atomic-insight-user-actions-session.tsx","src/components/insight/user-actions/atomic-insight-user-actions-timeline/atomic-insight-user-actions-timeline.pcss?tag=atomic-insight-user-actions-timeline&encapsulation=shadow","src/components/insight/user-actions/atomic-insight-user-actions-timeline/atomic-insight-user-actions-timeline.tsx"],"sourcesContent":["import {UserAction as IUserAction} from '@coveo/headless/insight';\nimport {FunctionalComponent, h} from '@stencil/core';\nimport BookmarkIcon from '../../../../images/bookmark.svg';\nimport DocumentIcon from '../../../../images/document.svg';\nimport PointIcon from '../../../../images/point.svg';\nimport QuickviewIcon from '../../../../images/quickview.svg';\nimport SearchIcon from '../../../../images/search.svg';\nimport {parseTimestampToDateDetails} from '../../../../utils/date-utils';\nimport {InsightBindings} from '../../atomic-insight-interface/atomic-insight-interface';\n\nconst icons = {\n  SEARCH: SearchIcon,\n  CLICK: DocumentIcon,\n  VIEW: QuickviewIcon,\n  CUSTOM: PointIcon,\n  TICKET_CREATION: BookmarkIcon,\n};\n\ninterface UserAction {\n  action: IUserAction;\n  bindings: InsightBindings;\n}\n\nexport const UserAction: FunctionalComponent<UserAction> = ({\n  bindings,\n  action,\n}) => {\n  const renderActionTimestamp = () => {\n    const {hours, minutes} = parseTimestampToDateDetails(action.timestamp);\n\n    const formattedHours = String(hours).padStart(2, '0');\n    const formattedMinutes = String(minutes).padStart(2, '0');\n\n    return `${formattedHours}:${formattedMinutes}`;\n  };\n\n  const renderIcon = () => {\n    const iconClasses = `w-3 h-3 ${['CLICK', 'VIEW'].includes(action.actionType) ? 'text-primary' : ''}`;\n\n    return (\n      <atomic-icon\n        icon={icons[action.actionType]}\n        class={iconClasses}\n      ></atomic-icon>\n    );\n  };\n\n  const renderActionTitle = () => {\n    switch (action.actionType) {\n      case 'TICKET_CREATION':\n        return (\n          <div class=\"ticket-creation-action__text text-xs font-semibold\">\n            {bindings.i18n.t('ticket-created')}\n          </div>\n        );\n      case 'CUSTOM':\n        return (\n          <div class=\"text-xs font-semibold\">\n            {action.eventData?.value ?? action.eventData?.type}\n          </div>\n        );\n      case 'SEARCH':\n        return (\n          <div class=\"text-xs font-semibold\">\n            {action.query || bindings.i18n.t('empty-search')}\n          </div>\n        );\n      case 'VIEW':\n        return (\n          <a\n            href={action.document?.contentIdValue}\n            class=\"text-primary text-xs font-semibold\"\n            target=\"_blank\"\n          >\n            {action.document?.title}\n          </a>\n        );\n      case 'CLICK':\n        return (\n          <div class=\"text-xs font-semibold\">{action.document?.title}</div>\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div class=\"flex\">\n      <div class=\"flex-none pr-2\">\n        <div class=\"flex justify-center py-1\">{renderIcon()}</div>\n        <div class=\"flex justify-center py-1\">\n          <div class=\"user-action__separator h-7 w-0.5 rounded\"></div>\n        </div>\n      </div>\n      <div class=\"flex-1\">\n        {renderActionTitle()}\n        <div class=\"text-neutral-dark text-xxs flex py-2 font-light\">\n          <div>{renderActionTimestamp()}</div>\n          <div class=\"px-2\">{action.searchHub}</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","@import '../../../../global/global.pcss';\n\n.session-start-icon__container {\n  background-color: #fbb439;\n}\n\n.user-action__separator {\n  @apply bg-neutral;\n}\n\n.ticket-creation-action__text {\n  @apply text-success;\n}\n\n.text-xxs {\n  font-size: 0.625rem;\n}\n","import {UserAction as IUserAction} from '@coveo/headless/insight';\nimport {Component, h, Prop, Watch, State} from '@stencil/core';\nimport Flag from '../../../../images/flag.svg';\nimport ThreeDotsIcon from '../../../../images/three-dots.svg';\nimport {parseTimestampToDateDetails} from '../../../../utils/date-utils';\nimport {InitializeBindings} from '../../../../utils/initialization-utils';\nimport {Button} from '../../../common/stencil-button';\nimport {InsightBindings} from '../../atomic-insight-interface/atomic-insight-interface';\nimport {UserAction} from './user-action';\n\nexport type UserActionType =\n  | 'SEARCH'\n  | 'CLICK'\n  | 'TICKET_CREATION'\n  | 'VIEW'\n  | 'CUSTOM';\n\n/**\n * @internal\n * The `AtomicInsightUserActionSession` component displays all the user actions that took place during a specific user session.\n * @category Insight Panel\n * @example\n * <atomic-insight-user-actions-session userActions={actions} startTimestamp={1723035731}></atomic-insight-user-actions-session>\n */\n@Component({\n  tag: 'atomic-insight-user-actions-session',\n  styleUrl: 'atomic-insight-user-actions-session.pcss',\n  shadow: true,\n})\nexport class AtomicInsightUserActionsSession {\n  @InitializeBindings() public bindings!: InsightBindings;\n  @State() public error!: Error;\n\n  /**\n   * The start time of the session as a Unix timestamp.\n   */\n  @Prop() public startTimestamp!: number;\n  /**\n   * The list of user actions performed during the session.\n   */\n  @Prop() public userActions!: Array<IUserAction>;\n\n  private userActionsToDisplay: Array<IUserAction> = [];\n  private userActionsAfterCaseCreation: Array<IUserAction> = [];\n  @State() areActionsAfterCaseCreationVisible = false;\n\n  connectedCallback() {\n    this.prepareUserActionsToDisplay();\n  }\n\n  @Watch('userActions')\n  prepareUserActionsToDisplay() {\n    const caseCreationIndex = this.userActions.findIndex(\n      ({actionType}) => actionType === 'TICKET_CREATION'\n    );\n    const isCaseCreationSession = caseCreationIndex !== -1;\n\n    if (!isCaseCreationSession) {\n      this.userActionsToDisplay = this.userActions;\n      this.userActionsAfterCaseCreation = [];\n    } else {\n      this.userActionsToDisplay = this.userActions.slice(caseCreationIndex);\n      this.userActionsAfterCaseCreation = this.userActions.slice(\n        0,\n        caseCreationIndex\n      );\n    }\n  }\n\n  showActionsAfterCaseCreation() {\n    this.areActionsAfterCaseCreationVisible = true;\n  }\n\n  renderSessionStartDate() {\n    const caseCreationIndex = this.userActions.findIndex(\n      ({actionType}) => actionType === 'TICKET_CREATION'\n    );\n    const isCaseCreationSession = caseCreationIndex !== -1;\n\n    const {year, month, dayOfWeek, day} = parseTimestampToDateDetails(\n      this.startTimestamp\n    );\n\n    const formatedStartDate = `${dayOfWeek}. ${month} ${day}, ${year}`;\n    return (\n      <div class=\"flex items-center px-2 pb-3\">\n        {isCaseCreationSession ? (\n          <div class=\"session-start-icon__container mr-2 flex h-5 w-5 items-center justify-center rounded-full\">\n            <atomic-icon icon={Flag} class=\"h-3 w-3\"></atomic-icon>\n          </div>\n        ) : null}\n\n        <div class=\"flex-1 font-semibold\">{formatedStartDate}</div>\n      </div>\n    );\n  }\n\n  renderActions(actions: Array<IUserAction>) {\n    return (\n      <ol class=\"px-3\">\n        {actions?.map((action) => (\n          <UserAction action={action} bindings={this.bindings}></UserAction>\n        ))}\n      </ol>\n    );\n  }\n\n  renderShowMoreActionsButton() {\n    const btnClasses = 'flex items-center p-1 max-w-full';\n    const label = this.bindings.i18n.t('more-actions-in-session', {\n      count: this.userActionsAfterCaseCreation.length,\n    });\n    return (\n      <div\n        data-testid=\"show-more-actions-button\"\n        class=\"flex items-center px-3 pb-3\"\n      >\n        <div class=\"flex justify-center pr-2\">\n          <atomic-icon icon={ThreeDotsIcon} class=\"h-3 w-3\"></atomic-icon>\n        </div>\n        <div class=\"flex-1\">\n          <Button\n            style=\"text-primary\"\n            part=\"show-more-actions-button\"\n            class={btnClasses}\n            ariaLabel={label}\n            onClick={this.showActionsAfterCaseCreation.bind(this)}\n          >\n            <span class=\"truncate text-xs font-light\">{label}</span>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  public render() {\n    const isShowMoreActionsButtonVisible =\n      !this.areActionsAfterCaseCreationVisible &&\n      !!this.userActionsAfterCaseCreation.length;\n\n    return (\n      <div>\n        {this.renderSessionStartDate()}\n\n        {this.areActionsAfterCaseCreationVisible && (\n          <div data-testid=\"more-actions-section\">\n            {this.renderActions(this.userActionsAfterCaseCreation)}\n          </div>\n        )}\n\n        {isShowMoreActionsButtonVisible && this.renderShowMoreActionsButton()}\n\n        {this.renderActions(this.userActionsToDisplay)}\n      </div>\n    );\n  }\n}\n","@import '../../../../global/global.pcss';\n\n.separator {\n  height: 1px;\n  background-color: #e0e1dd;\n}\n","import {\n  buildUserActions as buildInsightUserActions,\n  UserActions as InsightUserActions,\n  UserActionsState as InsightUserActionsState,\n  UserSession as InsightUserSession,\n} from '@coveo/headless/insight';\nimport {Component, h, State, Prop} from '@stencil/core';\nimport ArrowDownIcon from '../../../../images/big-arrow-down.svg';\nimport ArrowUpIcon from '../../../../images/big-arrow-up.svg';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n  BindStateToController,\n} from '../../../../utils/initialization-utils';\nimport {NoItemsContainer} from '../../../common/no-items/container';\nimport {MagnifyingGlass} from '../../../common/no-items/magnifying-glass';\nimport {Button} from '../../../common/stencil-button';\nimport {InsightBindings} from '../../atomic-insight-interface/atomic-insight-interface';\n\n/**\n * @internal\n * This component displays all the actions performed by a user around the time they created a case.\n * The actions are grouped into multiple sessions, including the session during which the case was created,\n * the sessions preceding the case creation and the sessions following the case creation.\n *\n * @component\n * @example\n * <AtomicInsightUserActionsTimeline userId={'123'} caseCreationDate={'2024-08-15T10:00:00Z'} />\n *\n */\n@Component({\n  tag: 'atomic-insight-user-actions-timeline',\n  styleUrl: 'atomic-insight-user-actions-timeline.pcss',\n  shadow: true,\n})\nexport class AtomicInsightUserActionsTimeline\n  implements InitializableComponent<InsightBindings>\n{\n  @InitializeBindings() public bindings!: InsightBindings;\n  public userActions!: InsightUserActions;\n\n  @BindStateToController('userActions')\n  @State()\n  public userActionsState!: InsightUserActionsState;\n  public error!: Error;\n\n  /**\n   * The ID of the user whose actions are being displayed. For example in email format \"someone@company.com\".\n   */\n  @Prop() public userId!: string;\n  /**\n   * The date and time when the case was created. For example \"2024-01-01T00:00:00Z\"\n   */\n  @Prop() public ticketCreationDateTime!: string;\n  /**\n   * The names of custom events to exclude.\n   */\n  @Prop() public excludedCustomActions: string[] = [];\n\n  public initialize() {\n    this.userActions = buildInsightUserActions(this.bindings.engine, {\n      options: {\n        ticketCreationDate: this.ticketCreationDateTime,\n        excludedCustomActions: this.excludedCustomActions,\n      },\n    });\n\n    this.userActions.fetchUserActions(this.userId);\n  }\n\n  @State() followingSessionsAreVisible = false;\n  @State() precedingSessionsAreVisible = false;\n\n  private toggleFollowingSessions() {\n    this.followingSessionsAreVisible = !this.followingSessionsAreVisible;\n  }\n\n  private togglePrecedingSessions() {\n    this.precedingSessionsAreVisible = !this.precedingSessionsAreVisible;\n  }\n\n  private renderSessions(\n    sessions: Array<InsightUserSession> | undefined,\n    renderSeparator?: Function,\n    testId?: string\n  ) {\n    return (\n      <div>\n        {sessions?.map(({actions, start}) => [\n          <div class=\"mt-4\">\n            <atomic-insight-user-actions-session\n              startTimestamp={start}\n              userActions={actions}\n              data-testid={testId}\n            ></atomic-insight-user-actions-session>\n          </div>,\n          renderSeparator ? renderSeparator() : null,\n        ])}\n      </div>\n    );\n  }\n\n  private renderToggleFollowingSessionsButton() {\n    const btnClasses = 'flex items-center text-left p-2 text-sm max-w-full';\n    const iconClasses = 'h-3 w-3 mr-1';\n    const label = this.followingSessionsAreVisible\n      ? this.bindings.i18n.t('hide-following-sessions')\n      : this.bindings.i18n.t('show-following-sessions');\n    const icon = this.followingSessionsAreVisible ? ArrowDownIcon : ArrowUpIcon;\n\n    return (\n      <div class=\"flex justify-center p-2\">\n        <Button\n          style=\"text-primary\"\n          part=\"toggle-following-sessions\"\n          class={btnClasses}\n          ariaLabel={label}\n          onClick={this.toggleFollowingSessions.bind(this)}\n        >\n          <atomic-icon\n            part=\"toggle-following-sessions-icon\"\n            class={iconClasses}\n            icon={icon}\n          ></atomic-icon>\n          <span class=\"truncate\">{label}</span>\n        </Button>\n      </div>\n    );\n  }\n\n  private renderTogglePrecedingSessionsButton() {\n    const btnClasses = 'flex items-center text-left p-2 text-sm max-w-full';\n    const iconClasses = 'h-3 w-3 mr-1';\n    const label = this.precedingSessionsAreVisible\n      ? this.bindings.i18n.t('hide-preceding-sessions')\n      : this.bindings.i18n.t('show-preceding-sessions');\n    const icon = this.precedingSessionsAreVisible ? ArrowUpIcon : ArrowDownIcon;\n\n    return (\n      <div class=\"flex justify-center p-2\">\n        <Button\n          style=\"text-primary\"\n          part=\"toggle-preceding-sessions\"\n          class={btnClasses}\n          ariaLabel={label}\n          onClick={this.togglePrecedingSessions.bind(this)}\n        >\n          <atomic-icon\n            part=\"toggle-preceding-sessions-icon\"\n            class={iconClasses}\n            icon={icon}\n          ></atomic-icon>\n          <span class=\"truncate\">{label}</span>\n        </Button>\n      </div>\n    );\n  }\n\n  private renderFollowingSessionsSection() {\n    if (!this.userActionsState.timeline?.followingSessions?.length) {\n      return null;\n    }\n    return [\n      this.renderToggleFollowingSessionsButton(),\n      <div class=\"separator mx-1 rounded\"></div>,\n      this.followingSessionsAreVisible\n        ? this.renderSessions(\n            this.userActionsState.timeline?.followingSessions,\n            () => <div class=\"separator mx-1 mt-4 rounded\"></div>,\n            'following-session'\n          )\n        : null,\n    ];\n  }\n\n  private renderPrecedingSessionsSection() {\n    if (!this.userActionsState.timeline?.precedingSessions?.length) {\n      return null;\n    }\n    return [\n      <div class=\"separator mx-1 mt-4 rounded\"></div>,\n      this.precedingSessionsAreVisible\n        ? this.renderSessions(\n            this.userActionsState.timeline?.precedingSessions,\n            () => <div class=\"separator mx-1 mt-4 rounded\"></div>,\n            'preceding-session'\n          )\n        : null,\n      this.renderTogglePrecedingSessionsButton(),\n    ];\n  }\n\n  private renderTimeline() {\n    return (\n      <div>\n        {this.renderFollowingSessionsSection()}\n        <div class=\"mt-4\">\n          <atomic-insight-user-actions-session\n            // eslint-disable-next-line @typescript-eslint/no-non-null-asserted-optional-chain\n            startTimestamp={this.userActionsState.timeline?.session?.start!}\n            // eslint-disable-next-line @typescript-eslint/no-non-null-asserted-optional-chain\n            userActions={this.userActionsState?.timeline?.session?.actions!}\n            data-testid=\"active-session\"\n          ></atomic-insight-user-actions-session>\n        </div>\n        {this.renderPrecedingSessionsSection()}\n      </div>\n    );\n  }\n\n  private renderNoUserActionsScreen() {\n    return (\n      <div class=\"my-6 py-3\" data-testid=\"user-actions-error\">\n        <NoItemsContainer>\n          <MagnifyingGlass />\n          <div class=\"my-2 max-w-full text-center text-2xl font-light\">\n            {this.bindings.i18n.t('no-user-actions-available')}\n          </div>\n          <div class=\"text-neutral-dark my-2 text-center text-lg\">\n            {this.bindings.i18n.t('no-user-actions-associated-with-params')}\n          </div>\n        </NoItemsContainer>\n      </div>\n    );\n  }\n\n  render() {\n    const areUserActionsAvailable = this.userActionsState.timeline?.session;\n    const hasError = this.userActionsState.error;\n\n    if (areUserActionsAvailable && !hasError) {\n      return this.renderTimeline();\n    }\n    return this.renderNoUserActionsScreen();\n  }\n}\n"],"version":3}