{"file":"atomic-smart-snippet-answer.atomic-smart-snippet-source.entry.js","mappings":"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","names":[],"sources":["src/components/common/smart-snippets/atomic-smart-snippet-answer/atomic-smart-snippet-answer.pcss?tag=atomic-smart-snippet-answer&encapsulation=shadow","src/components/common/smart-snippets/atomic-smart-snippet-answer/atomic-smart-snippet-answer.tsx","src/components/common/smart-snippets/atomic-smart-snippet-source.tsx"],"sourcesContent":["@import '../../../../global/global.pcss';\n:host {\n  @apply text-on-background text-lg;\n  line-height: calc(var(--text-lg) * var(--atomic-line-height-ratio));\n\n  .wrapper {\n    display: flow-root;\n    .margin {\n      margin: 1rem 0;\n    }\n  }\n}\n\np {\n  @apply mt-4 mb-4;\n}\n\nul,\nol {\n  @apply mb-4 list-outside list-decimal pl-10;\n}\n\na {\n  @apply text-primary underline;\n}\n","import {InlineLink} from '@coveo/headless';\nimport {\n  Component,\n  h,\n  Prop,\n  Event,\n  EventEmitter,\n  Host,\n  Element,\n} from '@stencil/core';\nimport DOMPurify from 'dompurify';\nimport {sanitizeStyle} from '../../../../utils/utils';\nimport {bindAnalyticsToLink} from '../../item-link/item-link';\n\n/**\n * @part answer - The container displaying the full document excerpt.\n * @internal\n */\n@Component({\n  tag: 'atomic-smart-snippet-answer',\n  styleUrl: 'atomic-smart-snippet-answer.pcss',\n  shadow: true,\n})\nexport class AtomicSmartSnippetAnswer {\n  @Prop() htmlContent!: string;\n  @Prop() innerStyle?: string;\n\n  @Element() public host!: HTMLElement;\n\n  @Event({bubbles: false})\n  private answerSizeUpdated!: EventEmitter<{height: number}>;\n  @Event({bubbles: false})\n  private selectInlineLink!: EventEmitter<InlineLink>;\n  @Event({bubbles: false})\n  private beginDelayedSelectInlineLink!: EventEmitter<InlineLink>;\n  @Event({bubbles: false})\n  private cancelPendingSelectInlineLink!: EventEmitter<InlineLink>;\n  private wrapperElement?: HTMLElement;\n  private isRendering = true;\n  private resizeObserver: ResizeObserver | undefined;\n\n  public componentWillRender() {\n    this.isRendering = true;\n  }\n\n  public componentDidRender() {\n    this.isRendering = false;\n    this.emitCurrentHeight();\n  }\n\n  public componentDidLoad() {\n    // Prevents initial transition\n    setTimeout(() => {\n      this.host.classList.add('loaded');\n    }, 0);\n  }\n\n  public connectedCallback() {\n    if (this.wrapperElement && this.resizeObserver) {\n      this.resizeObserver.observe(this.wrapperElement);\n    }\n  }\n\n  public disconnectedCallback() {\n    this.resizeObserver?.disconnect();\n  }\n\n  public setWrapperElement(element: HTMLElement) {\n    this.wrapperElement = element;\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n    }\n    this.resizeObserver = new ResizeObserver(() => this.emitCurrentHeight());\n    this.resizeObserver.observe(element);\n  }\n\n  private get sanitizedStyle() {\n    if (!this.innerStyle) {\n      return undefined;\n    }\n    return sanitizeStyle(this.innerStyle);\n  }\n\n  private emitCurrentHeight() {\n    if (this.isRendering) {\n      return;\n    }\n    this.answerSizeUpdated.emit({height: this.wrapperElement!.scrollHeight});\n  }\n\n  private bindAnalyticsToLink(element: HTMLAnchorElement) {\n    const link: InlineLink = {\n      linkText: element.innerText,\n      linkURL: element.href,\n    };\n    bindAnalyticsToLink(element, {\n      stopPropagation: false,\n      onSelect: () => this.selectInlineLink.emit(link),\n      onBeginDelayedSelect: () => this.beginDelayedSelectInlineLink.emit(link),\n      onCancelPendingSelect: () =>\n        this.cancelPendingSelectInlineLink.emit(link),\n    });\n  }\n\n  private bindAnalyticsToLinks(root: HTMLElement) {\n    Array.from(root.querySelectorAll('a')).forEach((link) =>\n      this.bindAnalyticsToLink(link)\n    );\n  }\n\n  private renderStyle() {\n    const style = this.sanitizedStyle;\n    if (!style) {\n      return;\n    }\n    // deepcode ignore ReactSetInnerHtml: Defined by implementer and sanitized by dompurify\n    return <style innerHTML={style}></style>;\n  }\n\n  private renderContent() {\n    return (\n      <div\n        class=\"wrapper\"\n        ref={(element) => element && this.setWrapperElement(element)}\n      >\n        {/* deepcode ignore ReactSetInnerHtml: Sanitized by back-end + dompurify */}\n        <div\n          innerHTML={DOMPurify.sanitize(this.htmlContent, {\n            USE_PROFILES: {html: true},\n          })}\n          ref={(element) => element && this.bindAnalyticsToLinks(element)}\n          part=\"answer\"\n          class=\"margin\"\n        ></div>\n      </div>\n    );\n  }\n\n  public render() {\n    return (\n      <Host>\n        {this.renderStyle()}\n        {this.renderContent()}\n      </Host>\n    );\n  }\n}\n","import {Result} from '@coveo/headless';\nimport {\n  Component,\n  Prop,\n  h,\n  Listen,\n  State,\n  EventEmitter,\n  Event,\n  Host,\n} from '@stencil/core';\nimport {\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../utils/initialization-utils';\nimport {ResultContextEvent} from '../../search/result-template-components/result-template-decorators';\nimport {AnyBindings} from '../interface/bindings';\nimport {LinkWithItemAnalytics} from '../item-link/item-link';\n\n/**\n * @part source-url\n * @part source-title\n * @internal\n */\n@Component({\n  tag: 'atomic-smart-snippet-source',\n  shadow: false,\n})\nexport class AtomicSmartSnippetSource\n  implements InitializableComponent<AnyBindings>\n{\n  @InitializeBindings() public bindings!: AnyBindings;\n  @Prop({reflect: true, mutable: true}) source!: Result;\n  @Prop() anchorAttributes?: Attr[];\n\n  @Event() selectSource!: EventEmitter;\n  @Event() beginDelayedSelectSource!: EventEmitter;\n  @Event() cancelPendingSelectSource!: EventEmitter;\n\n  @State() public error!: Error;\n\n  @Listen('atomic/resolveResult')\n  public resolveResult(event: ResultContextEvent<Result>) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.source) {\n      event.detail(this.source);\n    }\n  }\n\n  render() {\n    return (\n      <Host>\n        <LinkWithItemAnalytics\n          title={this.source.clickUri}\n          href={this.source.clickUri}\n          className=\"block truncate\"\n          part=\"source-url\"\n          attributes={this.anchorAttributes}\n          onSelect={() => this.selectSource.emit()}\n          onBeginDelayedSelect={() => this.beginDelayedSelectSource.emit()}\n          onCancelPendingSelect={() => this.cancelPendingSelectSource.emit()}\n        >\n          {this.source.clickUri}\n        </LinkWithItemAnalytics>\n        <LinkWithItemAnalytics\n          title={this.source.title}\n          href={this.source.clickUri}\n          attributes={this.anchorAttributes}\n          className=\"block\"\n          part=\"source-title\"\n          onSelect={() => this.selectSource.emit()}\n          onBeginDelayedSelect={() => this.beginDelayedSelectSource.emit()}\n          onCancelPendingSelect={() => this.cancelPendingSelectSource.emit()}\n        >\n          <atomic-result-text\n            field=\"title\"\n            default=\"no-title\"\n            key={this.source.uniqueId}\n          ></atomic-result-text>\n        </LinkWithItemAnalytics>\n      </Host>\n    );\n  }\n}\n"],"version":3}