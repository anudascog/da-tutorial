{"file":"atomic-commerce-category-facet.atomic-commerce-facet.atomic-commerce-facets.atomic-commerce-numeric-facet.atomic-commerce-timeframe-facet.entry.cjs.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,8BAA8B,GAAG,o04DAAo04D,CAAC;AAC524D,0CAAe,8BAA8B;;;;;;;;;;;;MCyFhC,2BAA2B;;;;;;QAiBO,gBAAW,GAAG,KAAK,CAAC;QAezD,iCAA4B,GAAG,CAAC,CAAC;;;2BAfkB,KAAK;;;;;;IAyBzD,UAAU;QACf,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO;SACR;QAED,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxBA,+DAAsC,CACpC,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,WAAW,EAChB,CAAC,GAAG,MAAM,IAAI,CAAC,sBAAsB,GAAG,GAAG,CAAC,EAC5C,IAAI,CAAC,QAAQ,CAAC,IAAI,CACnB,CAAC;QAEF,MAAM,SAAS,GAAc;YAC3B,KAAK,EAAE,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC;YACnD,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO;YAChC,OAAO,EAAE,IAAI,CAAC,IAAI;YAClB,QAAQ,EAAE,MAAM,IAAI,CAAC,QAAQ;SAC9B,CAAC;QAEFC,6BAAiB,CAAC,IAAI,CAAC,IAAI,EAAE;YAC3B,GAAG,SAAS;YACZ,SAAS,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM;YAChD,oBAAoB,EAAE,OAAO,IAAI,CAAC,UAAU,CAAC,eAAe,GAAG,CAAC,GAAG,CAAC,CAAC;SACtE,CAAC,CAAC;KACJ;IAED,IAAY,WAAW;QACrB,OAAO,IAAI,CAAC,UAAU,EAAE,WAAW,IAAI,UAAU,CAAC;KACnD;IAED,IAAY,YAAY;QACtB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAIC,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACtD;QACD,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAIA,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACtD;QACD,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAIA,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACpD;QACD,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,gBAAgB,GAAG,IAAIA,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACzD;QAED,OAAO;YACL,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;SACxC,CAAC;KACH;IAEM,oBAAoB;QACzB,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACzB,OAAO;SACR;QACD,IAAI,CAAC,0BAA0B,IAAI,CAAC;QACpC,IAAI,CAAC,0BAA0B,GAAG,SAAS,CAAC;KAC7C;IAEM,iBAAiB;QACtB,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAED,IAAY,QAAQ;QAClB,QACE,IAAI,CAAC,YAAY,CAAC,QAAQ;aACzB,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM;gBAC7B,CAAC,IAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE,MAAM,CAAC,EACjD;KACH;IAEM,qBAAqB,CAC1B,IAAa,EACb,IAAa,EACb,QAA2C;QAE3C,IACE,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,QAAQ,CAAC;YACzC,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,QAAQ,CAAC,EACzC;YACA,OAAOC,gEAAgC,CACrC,IAAI,CAAC,WAAW,EAChB,IAAI,CAAC,WAAW,CACjB,CAAC;SACH;QACD,OAAO,IAAI,CAAC;KACb;IAED,IAAY,UAAU;QACpB,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE,MAAM,CAAC;KACxD;IAEO,YAAY;QAClB,QACEC,QAACC,4BAAW,IACV,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,oBAAoB,EAClB,IAAI,CAAC,UAAU,CAAC,eAAe,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC,GAAG,CAAC,EAE7D,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,YAAY,EAAE,CAAC,EACf,gBAAgB,EAAE,OAAO,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,EAC9D,cAAc,EAAE;gBACd,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;gBACjD,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;aAC1B,EACD,SAAS,EAAE,CAAC,MAAM;gBAChB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;gBAChD,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;oBACpB,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;iBACtD;aACF,GACY,EACf;KACH;IAEO,iBAAiB;QACvB,QACED,QAACE,0CAAgB,IACf,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,EACxC,QAAQ,EAAE,CAAC,KAAa;gBACtB,IAAI,KAAK,KAAK,EAAE,EAAE;oBAChB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;oBAC/B,OAAO;iBACR;gBACD,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;gBACzC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;aACjC,EACD,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,GAC3B,EACpB;KACH;IAEO,gBAAgB,CAAC,OAA6B,EAAE,MAAe;QACrE,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,OAAO,IAAI,CAAC,cAAc,EAAE,CAAC;SAC9B;QAED,IAAI,MAAM,EAAE;YACV,QACEF,QAACG,oDAA+B,QAC9BH,QAACI,mDAA8B,IAC7B,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,OAAO,EAAE;oBACP,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;oBACtD,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;iBAC1B,GACD,EACFJ,QAACK,uDAAkC,IAAC,UAAU,EAAE,KAAK,IAClD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAK,CAAC,CACH,CACL,EAClC;SACH;QAED,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YACtB,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YAE/B,QACEL,QAACG,oDAA+B,QAC9BH,QAACM,8CAAyB,IACxB,UAAU,EAAE,WAAW,EACvB,KAAK,EAAE,IAAI,CAAC,UAAU,EAAE,KAAK,EAC7B,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,OAAO,EAAE;oBACP,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;oBACtD,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;iBACtC,GACD,EACFN,QAACK,uDAAkC,IAAC,UAAU,EAAE,KAAK,IAClD,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CACZ,CACL,EAClC;SACH;QAED,MAAM,YAAY,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;QAChC,MAAM,wBAAwB,GAAGE,+BAAoB,CACnD,IAAI,CAAC,UAAU,EAAE,KAAK,EACtB,YAAY,CAAC,KAAK,EAClB,IAAI,CAAC,QAAQ,CAAC,IAAI,CACnB,CAAC;QAEF,QACEP,QAACQ,iDAA4B,IAC3B,YAAY,EAAE,wBAAwB,EACtC,eAAe,EAAE,YAAY,CAAC,eAAe,EAC7C,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,WAAW,EAAE,YAAY,CAAC,WAAW,EACrC,OAAO,EAAE;gBACP,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;gBACtD,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;aAC1B,EACD,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,EAC9C,MAAM,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,SAAS,CAAC,EAAE,CAAC,IAEhER,QAACS,yDAAoC,QAClC,IAAI,CAAC,cAAc,EAAE,CACe,CACV,EAC/B;KACH;IAEO,WAAW,CACjB,UAA8B,EAC9B,qBAA8B,EAC9B,qBAA8B;QAE9B,MAAM,YAAY,GAAGF,+BAAoB,CACvC,IAAI,CAAC,UAAU,EAAE,KAAK,EACtB,UAAU,CAAC,KAAK,EAChB,IAAI,CAAC,QAAQ,CAAC,IAAI,CACnB,CAAC;QACF,MAAM,UAAU,GAAG,UAAU,CAAC,KAAK,KAAK,UAAU,CAAC;QACnD,QACEP,QAACU,gDAA2B,IAC1B,YAAY,EAAE,YAAY,EAC1B,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,WAAW,EAAE,UAAU,CAAC,WAAW,EACnC,UAAU,EAAE,UAAU,EACtB,eAAe,EAAE,UAAU,CAAC,eAAe,EAC3C,OAAO,EAAE;gBACP,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;gBACtD,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;aACrC,EACD,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,EAC9C,MAAM,EAAE,CAAC,OAAO;gBACd,qBAAqB;oBACnB,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;gBACrD,qBAAqB;oBACnB,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;aACtD,GAC4B,EAC/B;KACH;IAEO,cAAc;QACpB,MAAM,EAAC,MAAM,EAAE,qBAAqB,EAAE,eAAe,EAAC,GAAG,IAAI,CAAC,UAAU,CAAC;QACzE,MAAM,UAAU,GAAG,eAAe,GAAG,qBAAqB,GAAG,MAAM,CAAC;QAEpE,MAAM,QAAQ,GAAG,UAAU,EAAE,MAAM;cAC/B,eAAe;kBACb,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,QAAQ;kBAC1C,UAAU;cACZ,EAAE,CAAC;QAEP,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC,KAC3B,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,4BAA4B,CAAC,CAC1E,CAAC;KACH;IAEO,mBAAmB;QACzB,QACEV,QAACW,wDAAmC,QACjC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,MAC5CX,QAACY,6CAAwB,IACvB,KAAK,EAAE,KAAK,EACZ,KAAK,EAAE,IAAI,CAAC,UAAU,EAAE,KAAK,EAC7B,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,EAC9C,OAAO,EAAE;gBACP,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;gBACtD,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;aACtC,GACyB,CAC7B,CAAC,CACkC,EACtC;KACH;IAEO,aAAa;QACnB,QACEZ,QAACa,4CAAkB,IACjB,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,EACxC,eAAe,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM,EAC1D,cAAc,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,mBAAmB,GAC3C,EACtB;KACH;IAEO,kBAAkB;QACxB,QACEb,iBAAK,KAAK,EAAE,IAAI,CAAC,UAAU,GAAG,MAAM,GAAG,EAAE,IACvCA,QAACc,0CAAiB,IAChB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,UAAU,EAAE;gBACV,IAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC;gBAClE,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,gBAAgB,EAAE,CAAC;gBACnD,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;aAC7B,EACD,UAAU,EAAE;gBACV,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,gBAAgB,EAAE,CAAC;gBACnD,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;aAC7B,EACD,iBAAiB,EAAE,IAAI,CAAC,UAAU,CAAC,iBAAiB,EACpD,iBAAiB,EAAE,IAAI,CAAC,UAAU,CAAC,iBAAiB,GACjC,CACjB,EACN;KACH;IAEO,oBAAoB,CAC1B,KAAc,EACd,QAAgB;QAEhB,QACE,QAAQ,KAAK,YAAY;YACzB,OAAQ,KAA4B,EAAE,OAAO,KAAK,QAAQ,EAC1D;KACH;IAEM,MAAM;QACX,MAAM,EACJ,QAAQ,EAAE,EAAC,IAAI,EAAC,EAChB,UAAU,EAAE,EAAC,WAAW,EAAE,qBAAqB,EAAE,MAAM,EAAC,GACzD,GAAG,IAAI,CAAC;QAET,MAAM,EAAC,QAAQ,EAAE,oBAAoB,EAAC,GAAG,IAAI,CAAC,YAAY,CAAC;QAE3D,QACEd,QAACe,qBAAU,qDACT,OAAO,EAAE,IAAI,EACb,mBAAmB,EAAE,oBAAoB,EACzC,QAAQ,EAAE,QAAQ,EAClB,UAAU,EAAE,MAAM,CAAC,MAAM,GAAG,CAAC,IAG3Bf,QAACgB,+BAAc,uDACZ,IAAI,CAAC,YAAY,EAAE,EACnB,CAAC,IAAI,CAAC,WAAW,IAAI;YACpB,IAAI,CAAC,iBAAiB,EAAE;YACxBC,0DAA0B,CAAC,WAAW,CAAC,IACrCjB,QAACkB,cAAQ,QACN,WAAW,CAAC,MAAM,CAAC,MAAM,IACxBlB,QAACmB,wCAAgB,IACf,IAAI,EAAE,IAAI,EACV,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,KAAK,EAAE,WAAW,CAAC,KAAK,IAEvB,IAAI,CAAC,mBAAmB,EAAE,CACV,KAEnBnB,iBAAK,KAAK,EAAC,MAAM,GAAO,CACzB,EACA,IAAI,CAAC,aAAa,EAAE,CACZ,KAEXA,QAACkB,cAAQ,QACPlB,QAACmB,wCAAgB,IAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,WAAW,IAClD,IAAI,CAAC,UAAU,IACdnB,QAACK,uDAAkC,IACjC,UAAU,EAAE,IAAI,EAChB,SAAS,EAAC,MAAM,IAEf,qBAAqB;gBACpB,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,EAAE,IAAI,CAAC,CACjB,KAErCL,QAACS,yDAAoC,IAAC,SAAS,EAAC,MAAM,IACnD,IAAI,CAAC,cAAc,EAAE,CACe,CACxC,CACgB,EAClB,IAAI,CAAC,kBAAkB,EAAE,CACjB,CACZ;SACF,CACc,CAER,EACb;KACH;IAEO,gBAAgB;QACtB,IAAI,IAAI,CAAC,0BAA0B,EAAE;YACnC,OAAO;SACR;QACD,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CACpD,OAAO,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAC3C,CAAC;KACH;;;AA1a4BW;IAA5BC,sCAAkB,EAAE;6DAA4B;AAyB1CD;IAFNE,yCAAqB,CAAC,SAAS,CAAC;iEAEqC;AAY5DF;IADTG,wCAAc,CAAC,cAAc,CAAC;2EACW;;;AClI5C,MAAM,sBAAsB,GAAG,kr+EAAkr+E,CAAC;AAClt+E,kCAAe,sBAAsB;;;;;;;;;;;;MC2FxB,mBAAmB;;;;;;QAee,gBAAW,GAAG,KAAK,CAAC;;;2BAAN,KAAK;;;;;;IAuBzD,UAAU;QACf,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO;SACR;QACD,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,WAAW,EAAE,CAAC;KACpB;IAEM,iBAAiB;QACtB,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAEM,oBAAoB;QACzB,IAAI,CAAC,0BAA0B,IAAI,CAAC;QACpC,IAAI,CAAC,0BAA0B,GAAG,SAAS,CAAC;KAC7C;IAEM,qBAAqB,CAC1B,IAAa,EACb,IAAa,EACb,QAAmC;QAEnC,IACE,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC;YACjC,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,EACjC;YACA,OAAOxB,gEAAgC,CACrC,IAAI,CAAC,WAAW,EAChB,IAAI,CAAC,WAAW,CACjB,CAAC;SACH;QACD,OAAO,IAAI,CAAC;KACb;IAEM,MAAM;QACX,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO;SACR;QACD,MAAM,EAAC,QAAQ,EAAE,oBAAoB,EAAC,GAAG,IAAI,CAAC,YAAY,CAAC;QAC3D,QACEC,QAACe,qBAAU,IACT,OAAO,EAAE,IAAI,EACb,QAAQ,EAAE,QAAQ,EAClB,mBAAmB,EAAE,oBAAoB,EACzC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,IAG3Cf,QAACgB,+BAAc,QACbhB,QAACC,4BAAW,IACV,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,cAAc,EAAE;gBACd,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC;gBAC5C,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;aAC1B,EACD,oBAAoB,EAAE,IAAI,CAAC,YAAY,CAAC,MAAM,EAC9C,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,YAAY,EAAE,CAAC,EACf,gBAAgB,EAAE,OAAO,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,EAC9D,SAAS,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,SAAS,CAAC,EAAE,CAAC,GAC5C,EACd,IAAI,CAAC,UAAU,EAAE,CACH,CAER,EACb;KACH;IAEO,UAAU;QAChB,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,OAAO;SACR;QACD,QACED,QAACkB,cAAQ,QACPlB,QAACwB,6CAAqB,IACpB,iBAAiB,EAAE,IAAI,CAAC,UAAU,CAAC,iBAAiB,EACpD,uBAAuB,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,EACtD,UAAU,EAAE,IAAI,IAEhBxB,QAACE,0CAAgB,IACf,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,QAAQ,EAAE,CAAC,KAAK;gBACd,IAAI,KAAK,KAAK,EAAE,EAAE;oBAChB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;oBAC/B,OAAO;iBACR;gBACD,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;gBACzC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;aACjC,EACD,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,EAC7C,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,GACxC,CACoB,EACvBe,0DAA0B,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;cACpD,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAAE,IAAI,CAAC,aAAa,EAAE,CAAC;cAClD,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAC3C,EACX;KACH;IAEO,qBAAqB,CAAC,QAAiB,EAAE,KAAc;QAC7D,QACEjB,QAACmB,wCAAgB,IACf,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,KAAK,EAAE,KAAK,IAEZnB,gBAAI,IAAI,EAAC,QAAQ,EAAC,KAAK,EAAC,MAAM,IAC3B,QAAQ,CACN,CACY,EACnB;KACH;IAEO,mBAAmB;QACzB,OAAO,IAAI,CAAC,qBAAqB,CAC/B,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,MAC3CA,QAACyB,wCAAgB,OACX,IAAI,CAAC,eAAe,EACxB,UAAU,EAAE,KAAK,CAAC,KAAK,EACvB,SAAS,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,EACtD,QAAQ,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,EACpD,UAAU,EAAE,KAAK,CAAC,QAAQ,GAC1B,CACH,CAAC,CACH,CAAC;KACH;IAEO,YAAY;QAClB,OAAO,IAAI,CAAC,qBAAqB,CAC/B,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC;YAClC,MAAM,qCAAqC,GAAG,CAAC,KAAK,CAAC,CAAC;YACtD,MAAM,qCAAqC,GAAG,CAAC,KAAK,CAAC,CAAC;YAEtD,QACEzB,QAAC0B,4BAAU,OACL,IAAI,CAAC,eAAe,EACxB,UAAU,EAAE,KAAK,CAAC,eAAe,EACjC,SAAS,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC,EAChD,QAAQ,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,EAC9C,UAAU,EAAE,KAAK,CAAC,KAAK,EACvB,UAAU,EAAE,KAAK,CAAC,KAAK,EACvB,MAAM,EAAE,CAAC,GAAG;oBACV,IAAI,qCAAqC,EAAE;wBACzC,IAAI,CAAC,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;qBACpC;oBACD,IAAI,qCAAqC,EAAE;wBACzC,IAAI,CAAC,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;qBACpC;iBACF,GACD,EACF;SACH,CAAC,CACH,CAAC;KACH;IAEO,kBAAkB;QACxB,QACE1B,QAACc,0CAAiB,IAChB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,UAAU,EAAE;gBACV,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,gBAAgB,EAAE,CAAC;gBAC9C,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;aAC7B,EACD,UAAU,EAAE;gBACV,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,gBAAgB,EAAE,CAAC;gBAC9C,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;aAC7B,EACD,iBAAiB,EAAE,IAAI,CAAC,UAAU,CAAC,iBAAiB,EACpD,iBAAiB,EAAE,IAAI,CAAC,UAAU,CAAC,iBAAiB,GACjC,EACrB;KACH;IAEO,aAAa;QACnB,QACEd,QAACa,4CAAkB,IACjB,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,EACxC,eAAe,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM,EAC1D,cAAc,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,mBAAmB,GAC3C,EACtB;KACH;IAED,IAAY,YAAY;QACtB,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,EAAC,KAAK,EAAC,KAAK,KAAK,KAAK,MAAM,CAAC,CAAC;KACrE;IAED,IAAY,WAAW;QACrB,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,IAAI,UAAU,CAAC;KAClD;IAED,IAAY,eAAe;QAQzB,OAAO;YACL,gBAAgB,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK;YACnD,eAAe,EAAE,UAAU;YAC3B,eAAe,EAAE,KAAK;YACtB,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK;YAC5B,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI;SACzB,CAAC;KACH;IAED,IAAY,QAAQ;QAClB,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC;KACvC;IAEO,WAAW;QACjBhB,6BAAiB,CAAC,IAAI,CAAC,IAAI,EAAE;YAC3B,GAAG,IAAI,CAAC,SAAS;YACjB,SAAS,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM;YAChD,oBAAoB,EAAE,MAAM,IAAI,CAAC,YAAY,CAAC,MAAM;SACrD,CAAC,CAAC;KACJ;IAEO,YAAY;QAClBD,+DAAsC,CACpC,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,WAAW,EAChB,CAAC,GAAG,MAAM,IAAI,CAAC,sBAAsB,GAAG,GAAG,CAAC,EAC5C,IAAI,CAAC,QAAQ,CAAC,IAAI,CACnB,CAAC;KACH;IAED,IAAY,SAAS;QACnB,OAAO;YACL,KAAK,EAAE,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC;YACnD,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO;YAChC,OAAO,EAAE,IAAI,CAAC,IAAI;YAClB,QAAQ,EAAE,MAAM,IAAI,CAAC,QAAQ;SAC9B,CAAC;KACH;IAED,IAAY,YAAY;QAKtB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAIE,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACtD;QACD,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAIA,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACtD;QACD,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAIA,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACpD;QAED,OAAO;YACL,QAAQ,EAAE,IAAI,CAAC,aAAa;YAC5B,QAAQ,EAAE,IAAI,CAAC,aAAa;YAC5B,MAAM,EAAE,IAAI,CAAC,WAAW;SACzB,CAAC;KACH;IAEO,YAAY,CAClB,KAAc,EACd,QAAgB;QAEhB,QACE,QAAQ,KAAK,YAAY;YACzB,OAAQ,KAA2B,EAAE,OAAO,KAAK,QAAQ,EACzD;KACH;IAEO,gBAAgB;QACtB,IAAI,IAAI,CAAC,0BAA0B,EAAE;YACnC,OAAO;SACR;QACD,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CACpD,OAAO,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAC3C,CAAC;KACH;;;AA/T4BsB;IAA5BC,sCAAkB,EAAE;qDAA4B;AAyB1CD;IAFNE,yCAAqB,CAAC,SAAS,CAAC;yDAEqC;AAU5DF;IADTG,wCAAc,CAAC,cAAc,CAAC;mEACW;;;;;;;;;;;;;MC9F/B,oBAAoB;;;;;;;;;;QAaD,wBAAmB,GAAG,CAAC,CAAC;QAOrC,gBAAW,GAAG,KAAK,CAAC;mCAPe,CAAC;;;2BAOtB,KAAK;;IAE7B,UAAU;QACf,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,MAAM,EAAC,MAAM,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,MAAM,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;QAClD,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC,cAAc,EAAE,CAAC;QAClD,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,OAAO,EAAE,CAAC;QACpCI,6BAAuB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,WAAW;YACvD,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;SAChC,CAAC,CAAC;KACJ;IAEO,gBAAgB;QACtB,OAAO,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,KAAK,iBAAiB,CAAC;KAClE;IAED,IAAY,iBAAiB;QAC3B,OAAO,IAAI,CAAC,gBAAgB,EAAE,GAAGC,4BAAmB,GAAGC,oBAAW,CAAC;KACpE;IAEO,aAAa;QACnB,IAAIC,YAAM,CAAC;YACT,kBAAkB,EAAE,IAAIC,iBAAW,CAAC,EAAC,GAAG,EAAE,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAC,CAAC;SAC/D,CAAC,CAAC,QAAQ,CAAC;YACV,kBAAkB,EAAE,IAAI,CAAC,mBAAmB;SAC7C,CAAC,CAAC;KACJ;IAEO,mBAAmB,CAAC,KAAa;QACvC,IAAI,IAAI,CAAC,mBAAmB,KAAK,CAAC,CAAC,EAAE;YACnC,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC,mBAAmB;cAC3B,KAAK,GAAG,CAAC,GAAG,IAAI,CAAC,mBAAmB;cACpC,IAAI,CAAC;KACV;IAEM,MAAM;QACX,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,OAAO,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,IAAI,CAAC,mBAAmB,EAAC,CAAC,CAAC,CAAC,GAAG,CAAC,OAC7D/B,QAACgC,iCAAgB,IAAC,WAAW,EAAE,KAAK,EAAE,cAAc,EAAE,CAAC,GAAI,CAC5D,CAAC,CAAC;SACJ;QACD,QACEhC,QAACkB,cAAQ,QACN,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,EAAEe,OAAK;YAC3C,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,OAAO;aACR;YAED,MAAM,KAAK,GAAG,OAAW;gBACvB,WAAW,EAAE,IAAI,CAAC,mBAAmB,CAACA,OAAK,CAAC;gBAC5C,OAAO,EAAE,IAAI,CAAC,OAAO;gBACrB,KAAK,EAAE,KAAU;gBACjB,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,KAAK;gBACxB,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,OAAO;aACzB,CAAC,CAAC;YAEH,QAAQ,KAAK,CAAC,KAAK,CAAC,IAAI;gBACtB,KAAK,SAAS;oBACZ,QACEjC,sCACM,KAAK,EAAgB,GACF,EACzB;gBACJ,KAAK,gBAAgB;oBACnB,QACEA,8CACM,KAAK,EAAgB,GACM,EACjC;gBACJ,KAAK,WAAW;oBACd,QACEA,gDACM,KAAK,EAAa,GACW,EACnC;gBACJ,KAAK,cAAc;oBACjB,QACEA,+CACM,KAAK,EAAiB,GACM,EAClC;gBACJ,SAAS;;oBAEP,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;oBAC3D,OAAO;iBACR;aACF;SACF,CAAC,CACO,EACX;KACH;;;AAhH4BoB;IAA5BC,sCAAkB,EAAE;sDAA4B;AAgB1CD;IAFNE,yCAAqB,CAAC,gBAAgB,CAAC;iEAES;;ACnDnD,MAAM,6BAA6B,GAAG,218EAA218E,CAAC;AACl48E,yCAAe,6BAA6B;;;;;;;;;;;;MC0C/B,0BAA0B;;;QAmB7B,iBAAY,GAA+C,EAAE,CAAC;;;;QAazB,gBAAW,GAAG,KAAK,CAAC;;;;;;2BAAN,KAAK;;;IAQhE,IAAY,WAAW;QACrB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAIxB,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACpD;QACD,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;IAIM,UAAU;QACf,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO;SACR;QAED,IAAI,CAAC,OAAO,GAAGoC,qBAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QAClD,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,oBAAoB,EAAE,CAAC;KAC7B;IAEM,iBAAiB;QACtB,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAEM,oBAAoB;QACzB,IAAI,CAAC,0BAA0B,IAAI,CAAC;QACpC,IAAI,CAAC,0BAA0B,GAAG,SAAS,CAAC;KAC7C;IAED,IAAY,SAAS;QACnB,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU,IAAI,IAAI,CAAC,KAAK,KAAK,gBAAgB,EAAE;YAChE,OAAOC,qCAAwB,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SAC7D;QACD,OAAOC,mCAAsB,CAAC;KAC/B;IAEO,oBAAoB;QAC1B,MAAM,EAAC,OAAO,EAAC,GAAG,IAAI,CAAC,UAAU,CAAC;QAClC,MAAM,SAAS,GAAc;YAC3B,KAAK,EAAE,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC;YACnD,OAAO,EAAE,OAAO;YAChB,OAAO,EAAE,IAAI,CAAC,IAAI;YAClB,QAAQ,EAAE,MAAM,IAAI,CAAC,QAAQ;SAC9B,CAAC;QAEFvC,6BAAiB,CAAC,IAAI,CAAC,IAAI,EAAE;YAC3B,GAAG,SAAS;YACZ,SAAS,EAAE,MAAM,IAAI,CAAC,SAAS;YAC/B,oBAAoB,EAAE,MAAM,IAAI,CAAC,sBAAsB;SACxD,CAAC,CAAC;KACJ;IAGM,gBAAgB,CAAC,EAAC,MAAM,EAAqB;QAClD,MAAM,EAAC,KAAK,EAAE,GAAG,EAAC,GAAG,MAAM,CAAC;QAC5B,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;YACnB;gBACE,KAAK;gBACL,GAAG;gBACH,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,UAAU;aAClB;SACF,CAAC,CAAC;KACJ;IAEM,MAAM;QACX,MAAM,EACJ,QAAQ,EAAE,EAAC,IAAI,EAAC,GACjB,GAAG,IAAI,CAAC;QACT,MAAM,EAAC,oBAAoB,EAAE,QAAQ,EAAC,GAAG,IAAI,CAAC,YAAY,CAAC;QAC3D,QACEG,QAACe,qBAAU,qDACT,OAAO,EAAE,IAAI,EACb,mBAAmB,EAAE,oBAAoB,EACzC,QAAQ,EAAE,QAAQ,EAClB,UAAU,EAAE,IAAI,CAAC,iBAAiB,IAGhCf,QAACgB,+BAAc,uDACbhB,QAACC,4BAAW,qDACV,IAAI,EAAE,IAAI,EACV,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,cAAc,EAAE;gBACd,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;gBACpC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;aAC1B,EACD,oBAAoB,EAAE,IAAI,CAAC,sBAAsB,EACjD,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,YAAY,EAAE,CAAC,EACf,gBAAgB,EAAE,OAAO,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,EAC9D,SAAS,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE,CAAC,GACjD,EACD,CAAC,IAAI,CAAC,WAAW,IAAI;YACpB,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,YAAY,EAAE;YAC9C,IAAI,CAAC,iBAAiB,KACpBD,iGACE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,KAAK,EAAE,IAAI,CAAC,KAAK,EACjB,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,WAAW,GACE,CACvC;SACF,CACc,CAER,EACb;KACH;IAEO,YAAY;QAClB,MAAM,EACJ,YAAY,EACZ,WAAW,EACX,QAAQ,EAAE,EACR,IAAI,EACJ,MAAM,EAAE,EAAC,MAAM,EAAC,GACjB,EACD,SAAS,GACV,GAAG,IAAI,CAAC;QAET,QACEA,QAACqC,2CAA2B,IAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,WAAW,IACxD,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,KAAK,MAC7BrC,QAACsC,qCAAqB,IACpB,SAAS,EAAE,SAAS,EACpB,eAAe,EAAE,UAAU,EAC3B,UAAU,EAAE,KAAK,EACjB,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,EAC5B,IAAI,EAAE,IAAI,EACV,MAAM,EAAE,MAAM,EACd,YAAY,EAAE,YAAY,EAC1B,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,GAC7C,CACH,CAAC,CAC0B,EAC9B;KACH;IAED,IAAY,WAAW;QACrB,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,IAAI,UAAU,CAAC;KAClD;IAED,IAAY,sBAAsB;QAChC,QACE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,EAAC,KAAK,EAAC,KAAK,KAAK,KAAK,UAAU,CAAC,CAAC,MAAM;YACvE,CAAC,EACD;KACH;IAED,IAAY,aAAa;QACvB,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;KACrE;IAED,IAAY,kBAAkB;QAC5B,OAAO,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;KAC5D;IAED,IAAY,cAAc;QACxB,QACE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAC3B,CAAC,KAAK,KAAK,KAAK,CAAC,eAAe,IAAI,KAAK,CAAC,KAAK,KAAK,MAAM,CAC3D,IAAI,EAAE,EACP;KACH;IAED,IAAY,iBAAiB;QAC3B,MAAM,EACJ,oBAAoB,EAAE,mBAAmB,EACzC,QAAQ,EACR,SAAS,EACT,WAAW,EAAE,UAAU,GACxB,GAAG,IAAI,CAAC,YAAY,CAAC;QACtB,OAAOC,kDAA+B,CAAC;YACrC,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,iBAAiB,EAAE;gBACjB,mBAAmB;gBACnB,QAAQ;gBACR,UAAU;gBACV,SAAS;aACV;YACD,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM;YACnC,QAAQ,EAAE,IAAI;SACf,CAAC,CAAC;KACJ;IAED,IAAY,QAAQ;QAClB,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC;KAChC;IAED,IAAY,iBAAiB;QAC3B,OAAO,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,kBAAkB,CAAC;KAC1D;IAED,IAAY,SAAS;QACnB,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,EAAE;YACjC,OAAO,IAAI,CAAC;SACb;QAED,OAAO,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;KACrC;IAEO,gBAAgB;QACtB,IAAI,IAAI,CAAC,0BAA0B,EAAE;YACnC,OAAO;SACR;QACD,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CACpD,OAAO,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAC3C,CAAC;KACH;;;AApP4BnB;IAA5BC,sCAAkB,EAAE;4DAA4B;AAK1CD;IAFNE,yCAAqB,CAAC,OAAO,CAAC;8DAEO;AAI/BF;IAFNE,yCAAqB,CAAC,SAAS,CAAC;gEAEqC;AAGpCF;IAAjCE,yCAAqB,CAAC,SAAS,CAAC;gEAA6B;;;AC1DhE,MAAM,+BAA+B,GAAG,gz2DAAgz2D,CAAC;AACz12D,2CAAe,+BAA+B;;;;;;;;;;;;MCwCjC,4BAA4B;;;;;;QAiBM,gBAAW,GAAG,KAAK,CAAC;;;2BAAN,KAAK;;;;;;;IAmBhE,IAAY,WAAW;QACrB,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,IAAI,UAAU,CAAC;KAClD;IAED,IAAY,WAAW;QACrB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,GAAG,IAAIxB,+CAAqB,CAAC,IAAI,CAAC,CAAC;SACpD;QACD,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;IAIM,UAAU;QACf,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,OAAO;SACR;QACD,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,oBAAoB,EAAE,CAAC;KAC7B;IAEM,iBAAiB;QACtB,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAGM,cAAc,CAAC,EAAC,MAAM,EAA+B;QAC1D,IAAI,CAAC,UAAU,GAAG,EAAC,KAAK,EAAE,MAAM,CAAC,KAAK,EAAE,GAAG,EAAE,MAAM,CAAC,GAAG,EAAC,CAAC;KAC1D;IAED,IAAY,cAAc;QACxB,QACE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAC3B,CAAC,KAAK,KAAK,KAAK,CAAC,eAAe,IAAI,KAAK,CAAC,KAAK,KAAK,MAAM,CAC3D,IAAI,EAAE,EACP;KACH;IAED,IAAY,kBAAkB;QAC5B,OAAO,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;KAC5D;IAED,IAAY,iBAAiB;QAC3B,OAAO,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,kBAAkB,CAAC;KAC1D;IAED,IAAY,iBAAiB;QAC3B,MAAM,EACJ,oBAAoB,EAAE,mBAAmB,EACzC,QAAQ,EACR,SAAS,EACT,WAAW,EAAE,UAAU,GACxB,GAAG,IAAI,CAAC,YAAY,CAAC;QACtB,OAAOyC,kDAA+B,CAAC;YACrC,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,iBAAiB,EAAE;gBACjB,mBAAmB;gBACnB,QAAQ;gBACR,UAAU;gBACV,SAAS;aACV;YACD,WAAW,EAAE,IAAI,CAAC,UAAU,CAAC,MAAM,IAAI,EAAE;YACzC,QAAQ,EAAE,IAAI;SACf,CAAC,CAAC;KACJ;IAED,IAAY,SAAS;QACnB,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,EAAE;YACjC,OAAO,IAAI,CAAC;SACb;QAED,OAAO,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;KACrC;IAED,IAAY,sBAAsB;QAChC,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,OAAO,CAAC,CAAC;SACV;QAED,QACE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,EAAC,KAAK,EAAC,KAAK,KAAK,KAAK,UAAU,CAAC,CAAC,MAAM;YACvE,CAAC,EACD;KACH;IAED,IAAY,aAAa;QACvB,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC;KAC1B;IAEM,oBAAoB;QACzB,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACzB,OAAO;SACR;QACD,IAAI,CAAC,0BAA0B,IAAI,CAAC;QACpC,IAAI,CAAC,0BAA0B,GAAG,SAAS,CAAC;KAC7C;IAED,IAAY,QAAQ;QAClB,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC;KAChC;IAEO,UAAU;QAChB,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC5B,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;KAC1B;IAEO,oBAAoB;QAC1B,MAAM,SAAS,GAAc;YAC3B,KAAK,EAAE,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC;YACnD,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO;YAChC,OAAO,EAAE,IAAI,CAAC,IAAI;YAClB,QAAQ,EAAE,MAAM,IAAI,CAAC,QAAQ;SAC9B,CAAC;QAEF1C,6BAAiB,CAAC,IAAI,CAAC,IAAI,EAAE;YAC3B,GAAG,SAAS;YACZ,SAAS,EAAE,MAAM,IAAI,CAAC,SAAS;YAC/B,oBAAoB,EAAE,MAAM,IAAI,CAAC,sBAAsB;SACxD,CAAC,CAAC;KACJ;IAEO,gBAAgB,CAAC,UAA0B;QACjD,IAAI;YACF,MAAM,SAAS,GAAG2C,gCAAuB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAC5D,MAAM,YAAY,GAChB,SAAS,CAAC,MAAM,KAAK,MAAM;kBACvB,SAAS;kBACTA,gCAAuB,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;YAE9C,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CACzB,GAAG,YAAY,CAAC,MAAM,IAAI,YAAY,CAAC,IAAI,EAAE,EAC7C;gBACE,KAAK,EAAE,YAAY,CAAC,MAAM;aAC3B,CACF,CAAC;SACH;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE;gBAChC,KAAK,EAAEC,mBAAS,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC;gBACvD,GAAG,EAAEA,mBAAS,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC;aACpD,CAAC,CAAC;SACJ;KACF;IACO,YAAY;QAClB,OAAO,IAAI,CAAC,qBAAqB,CAC/B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAC5D,CAAC;KACH;IAEO,WAAW,CAAC,UAA0B;QAC5C,MAAM,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;QACvD,MAAM,UAAU,GAAG,UAAU,CAAC,KAAK,KAAK,UAAU,CAAC;QACnD,MAAM,UAAU,GAAG,UAAU,CAAC,KAAK,KAAK,UAAU,CAAC;QACnD,QACEzC,QAAC0C,oCAAc,IACb,YAAY,EAAE,YAAY,EAC1B,UAAU,EAAE,UAAU,EACtB,eAAe,EAAE,UAAU,CAAC,eAAe,EAC3C,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAExD1C,QAAC2C,wDAAwB,IACvB,YAAY,EAAE,YAAY,EAC1B,UAAU,EAAE,UAAU,EACtB,UAAU,EAAE,UAAU,GACI,CACb,EACjB;KACH;IAEO,qBAAqB,CAAC,QAAiB;QAC7C,QACE3C,QAACmB,wCAAgB,IAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,WAAW,IACjEnB,gBAAI,KAAK,EAAC,MAAM,EAAC,IAAI,EAAC,QAAQ,IAC3B,QAAQ,CACN,CACY,EACnB;KACH;IAEO,YAAY;QAClB,QACEA,QAACC,4BAAW,IACV,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,EACxB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,cAAc,EAAE;gBACd,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,CAAC;gBACpC,IAAI,IAAI,CAAC,aAAa,EAAE;oBACtB,IAAI,CAAC,UAAU,EAAE,CAAC;oBAClB,OAAO;iBACR;gBACD,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;aAC1B,EACD,oBAAoB,EAAE,IAAI,CAAC,sBAAsB,EACjD,WAAW,EAAE,IAAI,CAAC,WAAW,EAC7B,YAAY,EAAE,CAAC,EACf,gBAAgB,EAAE,OAAO,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,EAC9D,SAAS,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE,CAAC,GACpC,EACf;KACH;IAEO,eAAe;QACrB,QACED,qCACE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EACvB,KAAK,EAAE,IAAI,CAAC,WAAW,EACvB,WAAW,EAAE,MAAM,IAAI,CAAC,UAAU,EAClC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO,EAChC,WAAW,EAAE,CAAC,EAAC,KAAK,EAAE,GAAG,EAAE,YAAY,EAAmB;gBACxD,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;oBACnB;wBACE,KAAK;wBACL,GAAG;wBACH,YAAY;wBACZ,KAAK,EAAE,UAAU;qBAClB;iBACF,CAAC,CAAC;aACJ,GACwB,EAC3B;KACH;IAEM,MAAM;QACX,MAAM,EAAC,QAAQ,EAAE,oBAAoB,EAAC,GAAG,IAAI,CAAC,YAAY,CAAC;QAE3D,QACEA,QAACe,qBAAU,qDACT,OAAO,EAAE,IAAI,EACb,mBAAmB,EAAE,oBAAoB,EACzC,QAAQ,EAAE,QAAQ,EAClB,UAAU,EAAE,IAAI,CAAC,iBAAiB,IAGhCf,QAACgB,+BAAc,uDACZ,IAAI,CAAC,YAAY,EAAE,EACnB,CAAC,IAAI,CAAC,WAAW,IAAI;YACpB,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,YAAY,EAAE;YAC9C,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,eAAe,EAAE;SACjD,CACc,CAER,EACb;KACH;IAEO,gBAAgB;QACtB,IAAI,IAAI,CAAC,0BAA0B,EAAE;YACnC,OAAO;SACR;QACD,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CACpD,OAAO,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAC3C,CAAC;KACH;;;AA7R4B;IAA5BK,sCAAkB,EAAE;8DAA4B;AAyB1C;IAFNC,yCAAqB,CAAC,SAAS,CAAC;kEAEqC;;;;;;;;;","names":["announceFacetSearchResultsWithAriaLive","initializePopover","FocusTargetController","shouldUpdateFacetSearchComponent","h","FacetHeader","FacetSearchInput","CategoryFacetTreeValueContainer","CategoryFacetAllCategoryButton","CategoryFacetParentAsTreeContainer","CategoryFacetParentButton","getFieldValueCaption","CategoryFacetParentValueLink","CategoryFacetChildrenAsTreeContainer","CategoryFacetChildValueLink","CategoryFacetSearchResultsContainer","CategoryFacetSearchValue","FacetSearchMatches","FacetShowMoreLess","FacetGuard","FacetContainer","shouldDisplaySearchResults","Fragment","FacetValuesGroup","__decorate","InitializeBindings","BindStateToController","AriaLiveRegion","FacetSearchInputGuard","FacetSearchValue","FacetValue","createAppLoadedListener","buildProductListing","buildSearch","Schema","NumberValue","FacetPlaceholder","index","buildContext","defaultCurrencyFormatter","defaultNumberFormatter","NumericFacetValuesContainer","NumericFacetValueLink","shouldDisplayInputForFacetRange","deserializeRelativeDate","parseDate","FacetValueLink","FacetValueLabelHighlight"],"sources":["src/components/commerce/facets/atomic-commerce-category-facet/atomic-commerce-category-facet.pcss?tag=atomic-commerce-category-facet&encapsulation=shadow","src/components/commerce/facets/atomic-commerce-category-facet/atomic-commerce-category-facet.tsx","src/components/commerce/facets/atomic-commerce-facet/atomic-commerce-facet.pcss?tag=atomic-commerce-facet&encapsulation=shadow","src/components/commerce/facets/atomic-commerce-facet/atomic-commerce-facet.tsx","src/components/commerce/facets/atomic-commerce-facets/atomic-commerce-facets.tsx","src/components/commerce/facets/atomic-commerce-numeric-facet/atomic-commerce-numeric-facet.pcss?tag=atomic-commerce-numeric-facet&encapsulation=shadow","src/components/commerce/facets/atomic-commerce-numeric-facet/atomic-commerce-numeric-facet.tsx","src/components/commerce/facets/atomic-commerce-timeframe-facet/atomic-commerce-timeframe-facet.pcss?tag=atomic-commerce-timeframe-facet&encapsulation=shadow","src/components/commerce/facets/atomic-commerce-timeframe-facet/atomic-commerce-timeframe-facet.tsx"],"sourcesContent":["@import '../../../common/facets/facet-common.pcss';\n@import '../../../common/facets/facet-search/facet-search.pcss';\n\n[part~='active-parent'] {\n  @apply pl-9;\n}\n\n[part~='parents'] [part~='values'] {\n  @apply pl-9;\n}\n\n[part~='all-categories-button'],\n[part~='parent-button'] {\n  @apply relative flex w-full items-center py-2.5 pr-2 pl-7 text-left;\n}\n\n[part~='back-arrow'] {\n  @apply absolute left-1 h-5 w-5;\n}\n","import {\n  CategoryFacetState,\n  CategoryFacetValue,\n  CategoryFacet,\n  SearchSummaryState,\n  ProductListingSummaryState,\n  Summary,\n} from '@coveo/headless/commerce';\nimport {Component, h, State, Prop, Element, Fragment} from '@stencil/core';\nimport {getFieldValueCaption} from '../../../../utils/field-utils';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {\n  AriaLiveRegion,\n  FocusTargetController,\n} from '../../../../utils/stencil-accessibility-utils';\nimport {CategoryFacetAllCategoryButton} from '../../../common/facets/category-facet/all-categories-button';\nimport {CategoryFacetChildValueLink} from '../../../common/facets/category-facet/child-value-link';\nimport {CategoryFacetChildrenAsTreeContainer} from '../../../common/facets/category-facet/children-as-tree-container';\nimport {CategoryFacetParentAsTreeContainer} from '../../../common/facets/category-facet/parent-as-tree-container';\nimport {CategoryFacetParentButton} from '../../../common/facets/category-facet/parent-button';\nimport {CategoryFacetParentValueLink} from '../../../common/facets/category-facet/parent-value-link';\nimport {CategoryFacetSearchResultsContainer} from '../../../common/facets/category-facet/search-results-container';\nimport {CategoryFacetSearchValue} from '../../../common/facets/category-facet/search-value';\nimport {CategoryFacetTreeValueContainer} from '../../../common/facets/category-facet/value-as-tree-container';\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\nimport {FacetContainer} from '../../../common/facets/facet-container/stencil-facet-container';\nimport {FacetGuard} from '../../../common/facets/facet-guard';\nimport {FacetHeader} from '../../../common/facets/facet-header/stencil-facet-header';\nimport {announceFacetSearchResultsWithAriaLive} from '../../../common/facets/facet-search/facet-search-aria-live';\nimport {\n  shouldUpdateFacetSearchComponent,\n  shouldDisplaySearchResults,\n} from '../../../common/facets/facet-search/facet-search-utils';\nimport {FacetSearchInput} from '../../../common/facets/facet-search/stencil-facet-search-input';\nimport {FacetSearchMatches} from '../../../common/facets/facet-search/stencil-facet-search-matches';\nimport {FacetShowMoreLess} from '../../../common/facets/facet-show-more-less/stencil-facet-show-more-less';\nimport {FacetValuesGroup} from '../../../common/facets/facet-values-group/stencil-facet-values-group';\nimport {initializePopover} from '../../../common/facets/popover/popover-type';\nimport {CommerceBindings as Bindings} from '../../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * A facet is a list of values for a certain field occurring in the results, ordered using a configurable criteria (e.g., number of occurrences).\n * An `atomic-commerce-category-facet` displays a facet of values in a browsable, hierarchical fashion.\n *\n * @part facet - The wrapper for the entire facet.\n * @part placeholder - The placeholder shown before the first search is executed.\n *\n * @part label-button - The button that displays the label and allows to expand/collapse the facet.\n * @part label-button-icon - The label button icon.\n *\n * @part search-wrapper - The search box wrapper.\n * @part search-input - The search box input.\n * @part search-icon - The search box submit button.\n * @part search-clear-button - The button to clear the search box of input.\n * @part more-matches - The label indicating there are more matches for the current facet search query.\n * @part no-matches - The label indicating there are no matches for the current facet search query.\n * @part matches-query - The highlighted query inside the matches labels.\n * @part search-results - The search results container.\n * @part search-result - The search result value.\n * @part search-result-path - The search result path.\n * @part search-highlight - The highlighted query inside the facet values.\n *\n * @part parents - The container surrounding the whole hierarchy of values.\n * @part sub-parents - The container surrounding a sub-hierarchy of values.\n * @part values - The container surrounding either the children of the active value or the values at the base.\n * @part all-categories-button - The \"View all\" button displayed first within the parents.\n * @part parent-button - The clickable parent button displayed first within sub-parents.\n * @part active-parent - The clickable active parent displayed first within the last sub-parents.\n * @part value-link - The clickable value displayed first within values.\n * @part back-arrow - The back arrow displayed before the clickable parents.\n * @part value-label - The facet value label within a value button.\n * @part value-count - The facet value count within a value button.\n * @part leaf-value - A facet value with no child value.\n * @part node-value - A facet value with child values.\n *\n * @part show-more - The show more results button.\n * @part show-less - The show less results button.\n * @part show-more-less-icon - The icons of the show more & show less buttons.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-category-facet',\n  styleUrl: 'atomic-commerce-category-facet.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceCategoryFacet\n  implements InitializableComponent<Bindings>\n{\n  @InitializeBindings() public bindings!: Bindings;\n  @Element() private host!: HTMLElement;\n\n  /**\n   * The summary controller instance.\n   */\n  @Prop() summary!: Summary<SearchSummaryState | ProductListingSummaryState>;\n  /**\n   * The category facet controller instance.\n   */\n  @Prop() public facet!: CategoryFacet;\n  /**\n   * Specifies whether the facet is collapsed.\n   */\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\n  /**\n   * The field identifier for this facet.\n   */\n  @Prop({reflect: true}) field?: string;\n\n  @State()\n  public facetState!: CategoryFacetState;\n\n  @BindStateToController('summary')\n  @State()\n  public summaryState!: SearchSummaryState | ProductListingSummaryState;\n\n  @State() public error!: Error;\n\n  private resultIndexToFocusOnShowMore = 0;\n  private showLessFocus?: FocusTargetController;\n  private showMoreFocus?: FocusTargetController;\n  private headerFocus?: FocusTargetController;\n  private activeValueFocus?: FocusTargetController;\n  private unsubscribeFacetController?: () => void | undefined;\n\n  @AriaLiveRegion('facet-search')\n  protected facetSearchAriaMessage!: string;\n\n  public initialize() {\n    if (!this.facet) {\n      return;\n    }\n\n    this.ensureSubscribed();\n    announceFacetSearchResultsWithAriaLive(\n      this.facet,\n      this.displayName,\n      (msg) => (this.facetSearchAriaMessage = msg),\n      this.bindings.i18n\n    );\n\n    const facetInfo: FacetInfo = {\n      label: () => this.bindings.i18n.t(this.displayName),\n      facetId: this.facetState.facetId,\n      element: this.host,\n      isHidden: () => this.isHidden,\n    };\n\n    initializePopover(this.host, {\n      ...facetInfo,\n      hasValues: () => !!this.facetState.values.length,\n      numberOfActiveValues: () => (this.facetState.hasActiveValues ? 1 : 0),\n    });\n  }\n\n  private get displayName() {\n    return this.facetState?.displayName || 'no-label';\n  }\n\n  private get focusTargets() {\n    if (!this.showLessFocus) {\n      this.showLessFocus = new FocusTargetController(this);\n    }\n    if (!this.showMoreFocus) {\n      this.showMoreFocus = new FocusTargetController(this);\n    }\n    if (!this.headerFocus) {\n      this.headerFocus = new FocusTargetController(this);\n    }\n    if (!this.activeValueFocus) {\n      this.activeValueFocus = new FocusTargetController(this);\n    }\n\n    return {\n      showLessFocus: this.showLessFocus,\n      showMoreFocus: this.showMoreFocus,\n      headerFocus: this.headerFocus,\n      activeValueFocus: this.activeValueFocus,\n    };\n  }\n\n  public disconnectedCallback() {\n    if (this.host.isConnected) {\n      return;\n    }\n    this.unsubscribeFacetController?.();\n    this.unsubscribeFacetController = undefined;\n  }\n\n  public connectedCallback(): void {\n    this.ensureSubscribed();\n  }\n\n  private get isHidden() {\n    return (\n      this.summaryState.hasError ||\n      (!this.facetState.values.length &&\n        !this.facetState.selectedValueAncestry?.length)\n    );\n  }\n\n  public componentShouldUpdate(\n    next: unknown,\n    prev: unknown,\n    propName: keyof AtomicCommerceCategoryFacet\n  ) {\n    if (\n      this.isCategoryFacetState(prev, propName) &&\n      this.isCategoryFacetState(next, propName)\n    ) {\n      return shouldUpdateFacetSearchComponent(\n        next.facetSearch,\n        prev.facetSearch\n      );\n    }\n    return true;\n  }\n\n  private get hasParents() {\n    return !!this.facetState.selectedValueAncestry?.length;\n  }\n\n  private renderHeader() {\n    return (\n      <FacetHeader\n        i18n={this.bindings.i18n}\n        label={this.displayName}\n        numberOfActiveValues={\n          this.facetState.hasActiveValues && this.isCollapsed ? 1 : 0\n        }\n        isCollapsed={this.isCollapsed}\n        headingLevel={0}\n        onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\n        onClearFilters={() => {\n          this.focusTargets.headerFocus.focusAfterSearch();\n          this.facet.deselectAll();\n        }}\n        headerRef={(header) => {\n          this.focusTargets.headerFocus.setTarget(header);\n          if (!this.hasParents) {\n            this.focusTargets.activeValueFocus.setTarget(header);\n          }\n        }}\n      ></FacetHeader>\n    );\n  }\n\n  private renderSearchInput() {\n    return (\n      <FacetSearchInput\n        i18n={this.bindings.i18n}\n        label={this.displayName}\n        query={this.facetState.facetSearch.query}\n        onChange={(value: string) => {\n          if (value === '') {\n            this.facet.facetSearch.clear();\n            return;\n          }\n          this.facet.facetSearch.updateText(value);\n          this.facet.facetSearch.search();\n        }}\n        onClear={() => this.facet.facetSearch.clear()}\n      ></FacetSearchInput>\n    );\n  }\n\n  private renderValuesTree(parents: CategoryFacetValue[], isRoot: boolean) {\n    if (!this.hasParents) {\n      return this.renderChildren();\n    }\n\n    if (isRoot) {\n      return (\n        <CategoryFacetTreeValueContainer>\n          <CategoryFacetAllCategoryButton\n            i18n={this.bindings.i18n}\n            onClick={() => {\n              this.focusTargets.activeValueFocus.focusAfterSearch();\n              this.facet.deselectAll();\n            }}\n          />\n          <CategoryFacetParentAsTreeContainer isTopLevel={false}>\n            {this.renderValuesTree(parents, false)}\n          </CategoryFacetParentAsTreeContainer>\n        </CategoryFacetTreeValueContainer>\n      );\n    }\n\n    if (parents.length > 1) {\n      const parentValue = parents[0];\n\n      return (\n        <CategoryFacetTreeValueContainer>\n          <CategoryFacetParentButton\n            facetValue={parentValue}\n            field={this.facetState?.field}\n            i18n={this.bindings.i18n}\n            onClick={() => {\n              this.focusTargets.activeValueFocus.focusAfterSearch();\n              this.facet.toggleSelect(parentValue);\n            }}\n          />\n          <CategoryFacetParentAsTreeContainer isTopLevel={false}>\n            {this.renderValuesTree(parents.slice(1), false)}\n          </CategoryFacetParentAsTreeContainer>\n        </CategoryFacetTreeValueContainer>\n      );\n    }\n\n    const activeParent = parents[0];\n    const activeParentDisplayValue = getFieldValueCaption(\n      this.facetState?.field,\n      activeParent.value,\n      this.bindings.i18n\n    );\n\n    return (\n      <CategoryFacetParentValueLink\n        displayValue={activeParentDisplayValue}\n        numberOfResults={activeParent.numberOfResults}\n        i18n={this.bindings.i18n}\n        isLeafValue={activeParent.isLeafValue}\n        onClick={() => {\n          this.focusTargets.activeValueFocus.focusAfterSearch();\n          this.facet.deselectAll();\n        }}\n        searchQuery={this.facetState.facetSearch.query}\n        setRef={(el) => this.focusTargets.activeValueFocus.setTarget(el)}\n      >\n        <CategoryFacetChildrenAsTreeContainer>\n          {this.renderChildren()}\n        </CategoryFacetChildrenAsTreeContainer>\n      </CategoryFacetParentValueLink>\n    );\n  }\n\n  private renderChild(\n    facetValue: CategoryFacetValue,\n    isShowLessFocusTarget: boolean,\n    isShowMoreFocusTarget: boolean\n  ) {\n    const displayValue = getFieldValueCaption(\n      this.facetState?.field,\n      facetValue.value,\n      this.bindings.i18n\n    );\n    const isSelected = facetValue.state === 'selected';\n    return (\n      <CategoryFacetChildValueLink\n        displayValue={displayValue}\n        i18n={this.bindings.i18n}\n        isLeafValue={facetValue.isLeafValue}\n        isSelected={isSelected}\n        numberOfResults={facetValue.numberOfResults}\n        onClick={() => {\n          this.focusTargets.activeValueFocus.focusAfterSearch();\n          this.facet.toggleSelect(facetValue);\n        }}\n        searchQuery={this.facetState.facetSearch.query}\n        setRef={(element) => {\n          isShowLessFocusTarget &&\n            this.focusTargets.showLessFocus.setTarget(element);\n          isShowMoreFocusTarget &&\n            this.focusTargets.showMoreFocus.setTarget(element);\n        }}\n      ></CategoryFacetChildValueLink>\n    );\n  }\n\n  private renderChildren() {\n    const {values, selectedValueAncestry, hasActiveValues} = this.facetState;\n    const nextValues = hasActiveValues ? selectedValueAncestry : values;\n\n    const children = nextValues?.length\n      ? hasActiveValues\n        ? nextValues[nextValues.length - 1].children\n        : nextValues\n      : [];\n\n    return children.map((value, i) =>\n      this.renderChild(value, i === 0, i === this.resultIndexToFocusOnShowMore)\n    );\n  }\n\n  private renderSearchResults() {\n    return (\n      <CategoryFacetSearchResultsContainer>\n        {this.facetState.facetSearch.values.map((value) => (\n          <CategoryFacetSearchValue\n            value={value}\n            field={this.facetState?.field}\n            i18n={this.bindings.i18n}\n            searchQuery={this.facetState.facetSearch.query}\n            onClick={() => {\n              this.focusTargets.activeValueFocus.focusAfterSearch();\n              this.facet.facetSearch.select(value);\n            }}\n          ></CategoryFacetSearchValue>\n        ))}\n      </CategoryFacetSearchResultsContainer>\n    );\n  }\n\n  private renderMatches() {\n    return (\n      <FacetSearchMatches\n        i18n={this.bindings.i18n}\n        query={this.facetState.facetSearch.query}\n        numberOfMatches={this.facetState.facetSearch.values.length}\n        hasMoreMatches={this.facetState.facetSearch.moreValuesAvailable}\n      ></FacetSearchMatches>\n    );\n  }\n\n  private renderShowMoreLess() {\n    return (\n      <div class={this.hasParents ? 'pl-9' : ''}>\n        <FacetShowMoreLess\n          label={this.displayName}\n          i18n={this.bindings.i18n}\n          onShowMore={() => {\n            this.resultIndexToFocusOnShowMore = this.facetState.values.length;\n            this.focusTargets.showMoreFocus.focusAfterSearch();\n            this.facet.showMoreValues();\n          }}\n          onShowLess={() => {\n            this.focusTargets.showLessFocus.focusAfterSearch();\n            this.facet.showLessValues();\n          }}\n          canShowLessValues={this.facetState.canShowLessValues}\n          canShowMoreValues={this.facetState.canShowMoreValues}\n        ></FacetShowMoreLess>\n      </div>\n    );\n  }\n\n  private isCategoryFacetState(\n    state: unknown,\n    propName: string\n  ): state is CategoryFacetState {\n    return (\n      propName === 'facetState' &&\n      typeof (state as CategoryFacetState)?.facetId === 'string'\n    );\n  }\n\n  public render() {\n    const {\n      bindings: {i18n},\n      facetState: {facetSearch, selectedValueAncestry, values},\n    } = this;\n\n    const {hasError, firstRequestExecuted} = this.summaryState;\n\n    return (\n      <FacetGuard\n        enabled={true}\n        firstSearchExecuted={firstRequestExecuted}\n        hasError={hasError}\n        hasResults={values.length > 0}\n      >\n        {\n          <FacetContainer>\n            {this.renderHeader()}\n            {!this.isCollapsed && [\n              this.renderSearchInput(),\n              shouldDisplaySearchResults(facetSearch) ? (\n                <Fragment>\n                  {facetSearch.values.length ? (\n                    <FacetValuesGroup\n                      i18n={i18n}\n                      label={this.displayName}\n                      query={facetSearch.query}\n                    >\n                      {this.renderSearchResults()}\n                    </FacetValuesGroup>\n                  ) : (\n                    <div class=\"mt-3\"></div>\n                  )}\n                  {this.renderMatches()}\n                </Fragment>\n              ) : (\n                <Fragment>\n                  <FacetValuesGroup i18n={i18n} label={this.displayName}>\n                    {this.hasParents ? (\n                      <CategoryFacetParentAsTreeContainer\n                        isTopLevel={true}\n                        className=\"mt-3\"\n                      >\n                        {selectedValueAncestry &&\n                          this.renderValuesTree(selectedValueAncestry, true)}\n                      </CategoryFacetParentAsTreeContainer>\n                    ) : (\n                      <CategoryFacetChildrenAsTreeContainer className=\"mt-3\">\n                        {this.renderChildren()}\n                      </CategoryFacetChildrenAsTreeContainer>\n                    )}\n                  </FacetValuesGroup>\n                  {this.renderShowMoreLess()}\n                </Fragment>\n              ),\n            ]}\n          </FacetContainer>\n        }\n      </FacetGuard>\n    );\n  }\n\n  private ensureSubscribed() {\n    if (this.unsubscribeFacetController) {\n      return;\n    }\n    this.unsubscribeFacetController = this.facet.subscribe(\n      () => (this.facetState = this.facet.state)\n    );\n  }\n}\n","@import '../../../../global/global.pcss';\n@import '../../../common/facets/facet-search/facet-search.pcss';\n@import '../../../common/facets/facet-common.pcss';\n@import '../../../common/facets/facet-value-checkbox/facet-value-checkbox.pcss';\n@import '../../../common/facets/facet-value-exclude/facet-value-exclude.pcss';\n@import '../../../common/facets/facet-value-box/facet-value-box.pcss';\n","import {\n  ProductListingSummaryState,\n  RegularFacet,\n  RegularFacetState,\n  SearchSummaryState,\n  Summary,\n} from '@coveo/headless/commerce';\nimport {\n  Component,\n  h,\n  State,\n  Prop,\n  Element,\n  VNode,\n  Fragment,\n} from '@stencil/core';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {\n  AriaLiveRegion,\n  FocusTargetController,\n} from '../../../../utils/stencil-accessibility-utils';\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\nimport {FacetContainer} from '../../../common/facets/facet-container/stencil-facet-container';\nimport {FacetGuard} from '../../../common/facets/facet-guard';\nimport {FacetHeader} from '../../../common/facets/facet-header/stencil-facet-header';\nimport {announceFacetSearchResultsWithAriaLive} from '../../../common/facets/facet-search/facet-search-aria-live';\nimport {\n  shouldDisplaySearchResults,\n  shouldUpdateFacetSearchComponent,\n} from '../../../common/facets/facet-search/facet-search-utils';\nimport {FacetSearchInput} from '../../../common/facets/facet-search/stencil-facet-search-input';\nimport {FacetSearchInputGuard} from '../../../common/facets/facet-search/stencil-facet-search-input-guard';\nimport {FacetSearchMatches} from '../../../common/facets/facet-search/stencil-facet-search-matches';\nimport {FacetSearchValue} from '../../../common/facets/facet-search/stencil-facet-search-value';\nimport {FacetShowMoreLess} from '../../../common/facets/facet-show-more-less/stencil-facet-show-more-less';\nimport {\n  FacetValueProps,\n  FacetValue,\n} from '../../../common/facets/facet-value/stencil-facet-value';\nimport {FacetValuesGroup} from '../../../common/facets/facet-values-group/stencil-facet-values-group';\nimport {initializePopover} from '../../../common/facets/popover/popover-type';\nimport {CommerceBindings as Bindings} from '../../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * The `atomic-commerce-facet` component renders a commerce facet that the end user can interact with to filter products.\n *\n * @part facet - The wrapper for the entire facet.\n * @part placeholder - The placeholder shown before the first search is executed.\n *\n * @part label-button - The button that displays the label and allows to expand/collapse the facet.\n * @part label-button-icon - The label button icon.\n * @part clear-button - The button that resets the actively selected facet values.\n * @part clear-button-icon - The clear button icon.\n *\n * @part search-wrapper - The search box wrapper.\n * @part search-input - The search box input.\n * @part search-icon - The search box submit button.\n * @part search-clear-button - The button to clear the search box of input.\n * @part more-matches - The label indicating there are more matches for the current facet search query.\n * @part no-matches - The label indicating there are no matches for the current facet search query.\n * @part matches-query - The highlighted query inside the matches labels.\n * @part search-highlight - The highlighted query inside the facet values.\n *\n * @part values - The facet values container.\n * @part value-label - The facet value label, common for all displays.\n * @part value-count - The facet value count, common for all displays.\n *\n * @part value-checkbox - The facet value checkbox, available when display is 'checkbox'.\n * @part value-checkbox-checked - The checked facet value checkbox, available when display is 'checkbox'.\n * @part value-checkbox-label - The facet value checkbox clickable label, available when display is 'checkbox'.\n * @part value-checkbox-icon - The facet value checkbox icon, available when display is 'checkbox'.\n * @part value-link - The facet value when display is 'link'.\n * @part value-link-selected - The selected facet value when display is 'link'.\n * @part value-box - The facet value when display is 'box'.\n * @part value-box-selected - The selected facet value when display is 'box'.\n * @part value-exclude-button - The button to exclude a facet value, available when display is 'checkbox'.\n *\n * @part show-more - The show more results button.\n * @part show-less - The show less results button.\n * @part show-more-less-icon - The icons of the show more & show less buttons.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-facet',\n  styleUrl: 'atomic-commerce-facet.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceFacet implements InitializableComponent<Bindings> {\n  @InitializeBindings() public bindings!: Bindings;\n  @Element() private host!: HTMLElement;\n\n  /**\n   * The Summary controller instance.\n   */\n  @Prop() summary!: Summary<SearchSummaryState | ProductListingSummaryState>;\n  /**\n   * The facet controller instance.\n   */\n  @Prop() public facet!: RegularFacet;\n  /**\n   * Specifies whether the facet is collapsed.\n   */\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\n  /**\n   * The field identifier for this facet.\n   */\n  @Prop({reflect: true}) field?: string;\n\n  @State()\n  public facetState!: RegularFacetState;\n\n  @BindStateToController('summary')\n  @State()\n  public summaryState!: SearchSummaryState | ProductListingSummaryState;\n\n  @State() public error!: Error;\n\n  private showLessFocus?: FocusTargetController;\n  private showMoreFocus?: FocusTargetController;\n  private headerFocus?: FocusTargetController;\n  private unsubscribeFacetController?: () => void | undefined;\n\n  @AriaLiveRegion('facet-search')\n  protected facetSearchAriaMessage!: string;\n\n  public initialize() {\n    if (!this.facet) {\n      return;\n    }\n    this.ensureSubscribed();\n    this.initAriaLive();\n    this.initPopover();\n  }\n\n  public connectedCallback(): void {\n    this.ensureSubscribed();\n  }\n\n  public disconnectedCallback(): void {\n    this.unsubscribeFacetController?.();\n    this.unsubscribeFacetController = undefined;\n  }\n\n  public componentShouldUpdate(\n    next: unknown,\n    prev: unknown,\n    propName: keyof AtomicCommerceFacet\n  ) {\n    if (\n      this.isFacetState(prev, propName) &&\n      this.isFacetState(next, propName)\n    ) {\n      return shouldUpdateFacetSearchComponent(\n        next.facetSearch,\n        prev.facetSearch\n      );\n    }\n    return true;\n  }\n\n  public render() {\n    if (!this.facet) {\n      return;\n    }\n    const {hasError, firstRequestExecuted} = this.summaryState;\n    return (\n      <FacetGuard\n        enabled={true}\n        hasError={hasError}\n        firstSearchExecuted={firstRequestExecuted}\n        hasResults={this.facetState.values.length > 0}\n      >\n        {\n          <FacetContainer>\n            <FacetHeader\n              i18n={this.bindings.i18n}\n              label={this.displayName}\n              onClearFilters={() => {\n                this.focusTargets.header.focusAfterSearch();\n                this.facet.deselectAll();\n              }}\n              numberOfActiveValues={this.activeValues.length}\n              isCollapsed={this.isCollapsed}\n              headingLevel={0}\n              onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\n              headerRef={(el) => this.focusTargets.header.setTarget(el)}\n            ></FacetHeader>\n            {this.renderBody()}\n          </FacetContainer>\n        }\n      </FacetGuard>\n    );\n  }\n\n  private renderBody() {\n    if (this.isCollapsed) {\n      return;\n    }\n    return (\n      <Fragment>\n        <FacetSearchInputGuard\n          canShowMoreValues={this.facetState.canShowMoreValues}\n          numberOfDisplayedValues={this.facetState.values.length}\n          withSearch={true}\n        >\n          <FacetSearchInput\n            i18n={this.bindings.i18n}\n            label={this.displayName}\n            onChange={(value) => {\n              if (value === '') {\n                this.facet.facetSearch.clear();\n                return;\n              }\n              this.facet.facetSearch.updateText(value);\n              this.facet.facetSearch.search();\n            }}\n            onClear={() => this.facet.facetSearch.clear()}\n            query={this.facetState.facetSearch.query}\n          />\n        </FacetSearchInputGuard>\n        {shouldDisplaySearchResults(this.facetState.facetSearch)\n          ? [this.renderSearchResults(), this.renderMatches()]\n          : [this.renderValues(), this.renderShowMoreLess()]}\n      </Fragment>\n    );\n  }\n\n  private renderValuesContainer(children: VNode[], query?: string) {\n    return (\n      <FacetValuesGroup\n        i18n={this.bindings.i18n}\n        label={this.displayName}\n        query={query}\n      >\n        <ul part=\"values\" class=\"mt-3\">\n          {children}\n        </ul>\n      </FacetValuesGroup>\n    );\n  }\n\n  private renderSearchResults() {\n    return this.renderValuesContainer(\n      this.facetState.facetSearch.values.map((value) => (\n        <FacetSearchValue\n          {...this.facetValueProps}\n          facetCount={value.count}\n          onExclude={() => this.facet.facetSearch.exclude(value)}\n          onSelect={() => this.facet.facetSearch.select(value)}\n          facetValue={value.rawValue}\n        />\n      ))\n    );\n  }\n\n  private renderValues() {\n    return this.renderValuesContainer(\n      this.facetState.values.map((value, i) => {\n        const shouldFocusOnShowLessAfterInteraction = i === 0;\n        const shouldFocusOnShowMoreAfterInteraction = i === 0;\n\n        return (\n          <FacetValue\n            {...this.facetValueProps}\n            facetCount={value.numberOfResults}\n            onExclude={() => this.facet.toggleExclude(value)}\n            onSelect={() => this.facet.toggleSelect(value)}\n            facetValue={value.value}\n            facetState={value.state}\n            setRef={(btn) => {\n              if (shouldFocusOnShowLessAfterInteraction) {\n                this.showLessFocus?.setTarget(btn);\n              }\n              if (shouldFocusOnShowMoreAfterInteraction) {\n                this.showMoreFocus?.setTarget(btn);\n              }\n            }}\n          />\n        );\n      })\n    );\n  }\n\n  private renderShowMoreLess() {\n    return (\n      <FacetShowMoreLess\n        label={this.displayName}\n        i18n={this.bindings.i18n}\n        onShowMore={() => {\n          this.focusTargets.showMore.focusAfterSearch();\n          this.facet.showMoreValues();\n        }}\n        onShowLess={() => {\n          this.focusTargets.showLess.focusAfterSearch();\n          this.facet.showLessValues();\n        }}\n        canShowMoreValues={this.facetState.canShowMoreValues}\n        canShowLessValues={this.facetState.canShowLessValues}\n      ></FacetShowMoreLess>\n    );\n  }\n\n  private renderMatches() {\n    return (\n      <FacetSearchMatches\n        i18n={this.bindings.i18n}\n        query={this.facetState.facetSearch.query}\n        numberOfMatches={this.facetState.facetSearch.values.length}\n        hasMoreMatches={this.facetState.facetSearch.moreValuesAvailable}\n      ></FacetSearchMatches>\n    );\n  }\n\n  private get activeValues() {\n    return this.facetState.values.filter(({state}) => state !== 'idle');\n  }\n\n  private get displayName() {\n    return this.facetState.displayName || 'no-label';\n  }\n\n  private get facetValueProps(): Pick<\n    FacetValueProps,\n    | 'facetSearchQuery'\n    | 'enableExclusion'\n    | 'field'\n    | 'i18n'\n    | 'displayValuesAs'\n  > {\n    return {\n      facetSearchQuery: this.facetState.facetSearch.query,\n      displayValuesAs: 'checkbox',\n      enableExclusion: false,\n      field: this.facetState.field,\n      i18n: this.bindings.i18n,\n    };\n  }\n\n  private get isHidden() {\n    return !this.facetState.values.length;\n  }\n\n  private initPopover() {\n    initializePopover(this.host, {\n      ...this.facetInfo,\n      hasValues: () => !!this.facetState.values.length,\n      numberOfActiveValues: () => this.activeValues.length,\n    });\n  }\n\n  private initAriaLive() {\n    announceFacetSearchResultsWithAriaLive(\n      this.facet,\n      this.displayName,\n      (msg) => (this.facetSearchAriaMessage = msg),\n      this.bindings.i18n\n    );\n  }\n\n  private get facetInfo(): FacetInfo {\n    return {\n      label: () => this.bindings.i18n.t(this.displayName),\n      facetId: this.facetState.facetId,\n      element: this.host,\n      isHidden: () => this.isHidden,\n    };\n  }\n\n  private get focusTargets(): {\n    showLess: FocusTargetController;\n    showMore: FocusTargetController;\n    header: FocusTargetController;\n  } {\n    if (!this.showLessFocus) {\n      this.showLessFocus = new FocusTargetController(this);\n    }\n    if (!this.showMoreFocus) {\n      this.showMoreFocus = new FocusTargetController(this);\n    }\n    if (!this.headerFocus) {\n      this.headerFocus = new FocusTargetController(this);\n    }\n\n    return {\n      showLess: this.showLessFocus,\n      showMore: this.showMoreFocus,\n      header: this.headerFocus,\n    };\n  }\n\n  private isFacetState(\n    state: unknown,\n    propName: string\n  ): state is RegularFacetState {\n    return (\n      propName === 'facetState' &&\n      typeof (state as RegularFacetState)?.facetId === 'string'\n    );\n  }\n\n  private ensureSubscribed() {\n    if (this.unsubscribeFacetController) {\n      return;\n    }\n    this.unsubscribeFacetController = this.facet.subscribe(\n      () => (this.facetState = this.facet.state)\n    );\n  }\n}\n","import {NumberValue, Schema} from '@coveo/bueno';\nimport {\n  RegularFacet,\n  CategoryFacet,\n  DateFacet,\n  NumericFacet,\n  FacetGeneratorState,\n  buildProductListing,\n  buildSearch,\n  FacetGenerator,\n  Summary,\n  SearchSummaryState,\n  ProductListingSummaryState,\n} from '@coveo/headless/commerce';\nimport {Component, h, Element, State, Prop, Fragment} from '@stencil/core';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {FacetPlaceholder} from '../../../common/facets/facet-placeholder/facet-placeholder';\nimport {createAppLoadedListener} from '../../../common/interface/store';\nimport {CommerceBindings as Bindings} from '../../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * The `atomic-commerce-facets` component automatically renders commerce facets based on the Commerce API response.\n * Unlike regular facets, which require explicit definition and request in the query, the `atomic-commerce-facets` component dynamically generates facets.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-facets',\n  shadow: false,\n})\nexport class AtomicCommerceFacets implements InitializableComponent<Bindings> {\n  @InitializeBindings() public bindings!: Bindings;\n  public facetGenerator!: FacetGenerator;\n  public summary!: Summary<SearchSummaryState | ProductListingSummaryState>;\n  @Element() host!: HTMLElement;\n\n  /**\n   * The maximum number of facets to expand.\n   * Remaining facets are automatically collapsed.\n   *\n   * Using the value `0` collapses all facets.\n   * Using the value `-1` disables the feature and keeps all facets expanded.\n   */\n  @Prop({reflect: true}) public collapseFacetsAfter = 4;\n\n  @BindStateToController('facetGenerator')\n  @State()\n  public facetGeneratorState!: FacetGeneratorState;\n\n  @State() public error!: Error;\n  @State() private isAppLoaded = false;\n\n  public initialize() {\n    this.validateProps();\n    const {engine} = this.bindings;\n    const controller = this.controllerBuilder(engine);\n    this.facetGenerator = controller.facetGenerator();\n    this.summary = controller.summary();\n    createAppLoadedListener(this.bindings.store, (isAppLoaded) => {\n      this.isAppLoaded = isAppLoaded;\n    });\n  }\n\n  private isProductListing() {\n    return this.bindings.interfaceElement.type === 'product-listing';\n  }\n\n  private get controllerBuilder() {\n    return this.isProductListing() ? buildProductListing : buildSearch;\n  }\n\n  private validateProps() {\n    new Schema({\n      collapseFacetAfter: new NumberValue({min: -1, required: true}),\n    }).validate({\n      collapseFacetAfter: this.collapseFacetsAfter,\n    });\n  }\n\n  private shouldCollapseFacet(index: number): boolean {\n    if (this.collapseFacetsAfter === -1) {\n      return false;\n    }\n    return this.collapseFacetsAfter\n      ? index + 1 > this.collapseFacetsAfter\n      : true;\n  }\n\n  public render() {\n    if (!this.isAppLoaded) {\n      return [...Array.from({length: this.collapseFacetsAfter})].map(() => (\n        <FacetPlaceholder isCollapsed={false} numberOfValues={8} />\n      ));\n    }\n    return (\n      <Fragment>\n        {this.facetGenerator.facets.map((facet, index) => {\n          if (facet.state.values.length === 0) {\n            return;\n          }\n\n          const props = <T,>() => ({\n            isCollapsed: this.shouldCollapseFacet(index),\n            summary: this.summary,\n            facet: facet as T,\n            field: facet.state.field,\n            key: facet.state.facetId,\n          });\n\n          switch (facet.state.type) {\n            case 'regular':\n              return (\n                <atomic-commerce-facet\n                  {...props<RegularFacet>()}\n                ></atomic-commerce-facet>\n              );\n            case 'numericalRange':\n              return (\n                <atomic-commerce-numeric-facet\n                  {...props<NumericFacet>()}\n                ></atomic-commerce-numeric-facet>\n              );\n            case 'dateRange':\n              return (\n                <atomic-commerce-timeframe-facet\n                  {...props<DateFacet>()}\n                ></atomic-commerce-timeframe-facet>\n              );\n            case 'hierarchical':\n              return (\n                <atomic-commerce-category-facet\n                  {...props<CategoryFacet>()}\n                ></atomic-commerce-category-facet>\n              );\n            default: {\n              // TODO COMHUB-291 support location facet\n              this.bindings.engine.logger.warn('Unexpected facet type.');\n              return;\n            }\n          }\n        })}\n      </Fragment>\n    );\n  }\n}\n","@import '../../../common/facets/numeric-facet-common.pcss';\n","import {\n  NumericFacet,\n  NumericFacetState,\n  NumericRangeRequest,\n  ProductListingSummaryState,\n  SearchSummaryState,\n  Summary,\n  Context,\n  ContextState,\n  buildContext,\n} from '@coveo/headless/commerce';\nimport {Component, Element, h, Listen, Prop, State} from '@stencil/core';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {FocusTargetController} from '../../../../utils/stencil-accessibility-utils';\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\nimport {FacetContainer} from '../../../common/facets/facet-container/stencil-facet-container';\nimport {FacetGuard} from '../../../common/facets/facet-guard';\nimport {FacetHeader} from '../../../common/facets/facet-header/stencil-facet-header';\nimport {NumericFacetValueLink} from '../../../common/facets/numeric-facet/value-link';\nimport {NumericFacetValuesContainer} from '../../../common/facets/numeric-facet/values-container';\nimport {initializePopover} from '../../../common/facets/popover/popover-type';\nimport {shouldDisplayInputForFacetRange} from '../../../common/facets/stencil-facet-common';\nimport {\n  defaultCurrencyFormatter,\n  defaultNumberFormatter,\n} from '../../../common/formats/format-common';\nimport {CommerceBindings as Bindings} from '../../atomic-commerce-interface/atomic-commerce-interface';\nimport type {Range} from '../facet-number-input/atomic-commerce-facet-number-input';\n\n/**\n * The `atomic-commerce-numeric-facet` component is responsible for rendering a commerce facet that allows the user to filter products using numeric ranges.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-numeric-facet',\n  styleUrl: './atomic-commerce-numeric-facet.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceNumericFacet\n  implements InitializableComponent<Bindings>\n{\n  @InitializeBindings() public bindings!: Bindings;\n  @Element() private host!: HTMLElement;\n\n  @BindStateToController('facet')\n  @State()\n  public facetState!: NumericFacetState;\n\n  @BindStateToController('summary')\n  @State()\n  public summaryState!: SearchSummaryState | ProductListingSummaryState;\n\n  public context!: Context;\n  @BindStateToController('context') contextState!: ContextState;\n\n  @State() public error!: Error;\n\n  private manualRanges: (NumericRangeRequest & {label?: string})[] = [];\n\n  /**\n   * The Summary controller instance.\n   */\n  @Prop() summary!: Summary<SearchSummaryState | ProductListingSummaryState>;\n  /**\n   * The numeric facet controller instance.\n   */\n  @Prop({reflect: true}) public facet!: NumericFacet;\n  /**\n   * Specifies whether the facet is collapsed.\n   */\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\n  /**\n   * The field identifier for this facet.\n   */\n  @Prop({reflect: true}) field?: string;\n\n  private headerFocus?: FocusTargetController;\n\n  private get focusTarget(): FocusTargetController {\n    if (!this.headerFocus) {\n      this.headerFocus = new FocusTargetController(this);\n    }\n    return this.headerFocus;\n  }\n\n  private unsubscribeFacetController?: () => void | undefined;\n\n  public initialize() {\n    if (!this.facet) {\n      return;\n    }\n\n    this.context = buildContext(this.bindings.engine);\n    this.ensureSubscribed();\n    this.registerFacetToStore();\n  }\n\n  public connectedCallback() {\n    this.ensureSubscribed();\n  }\n\n  public disconnectedCallback() {\n    this.unsubscribeFacetController?.();\n    this.unsubscribeFacetController = undefined;\n  }\n\n  private get formatter() {\n    if (this.field === 'ec_price' || this.field === 'ec_promo_price') {\n      return defaultCurrencyFormatter(this.contextState.currency);\n    }\n    return defaultNumberFormatter;\n  }\n\n  private registerFacetToStore() {\n    const {facetId} = this.facetState;\n    const facetInfo: FacetInfo = {\n      label: () => this.bindings.i18n.t(this.displayName),\n      facetId: facetId,\n      element: this.host,\n      isHidden: () => this.isHidden,\n    };\n\n    initializePopover(this.host, {\n      ...facetInfo,\n      hasValues: () => this.hasValues,\n      numberOfActiveValues: () => this.numberOfSelectedValues,\n    });\n  }\n\n  @Listen('atomic/numberInputApply')\n  public applyNumberInput({detail}: CustomEvent<Range>) {\n    const {start, end} = detail;\n    this.facet.setRanges([\n      {\n        start,\n        end,\n        endInclusive: true,\n        state: 'selected',\n      },\n    ]);\n  }\n\n  public render() {\n    const {\n      bindings: {i18n},\n    } = this;\n    const {firstRequestExecuted, hasError} = this.summaryState;\n    return (\n      <FacetGuard\n        enabled={true}\n        firstSearchExecuted={firstRequestExecuted}\n        hasError={hasError}\n        hasResults={this.shouldRenderFacet}\n      >\n        {\n          <FacetContainer>\n            <FacetHeader\n              i18n={i18n}\n              label={this.displayName}\n              onClearFilters={() => {\n                this.focusTarget.focusAfterSearch();\n                this.facet.deselectAll();\n              }}\n              numberOfActiveValues={this.numberOfSelectedValues}\n              isCollapsed={this.isCollapsed}\n              headingLevel={0}\n              onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\n              headerRef={(el) => this.focusTarget.setTarget(el)}\n            />\n            {!this.isCollapsed && [\n              this.shouldRenderValues && this.renderValues(),\n              this.shouldRenderInput && (\n                <atomic-commerce-facet-number-input\n                  bindings={this.bindings}\n                  label={this.displayName}\n                  facet={this.facet}\n                  range={this.facetState.manualRange}\n                ></atomic-commerce-facet-number-input>\n              ),\n            ]}\n          </FacetContainer>\n        }\n      </FacetGuard>\n    );\n  }\n\n  private renderValues() {\n    const {\n      manualRanges,\n      displayName,\n      bindings: {\n        i18n,\n        engine: {logger},\n      },\n      formatter,\n    } = this;\n\n    return (\n      <NumericFacetValuesContainer i18n={i18n} label={displayName}>\n        {this.valuesToRender.map((value) => (\n          <NumericFacetValueLink\n            formatter={formatter}\n            displayValuesAs={'checkbox'}\n            facetValue={value}\n            field={this.facetState.field}\n            i18n={i18n}\n            logger={logger}\n            manualRanges={manualRanges}\n            onClick={() => this.facet.toggleSelect(value)}\n          />\n        ))}\n      </NumericFacetValuesContainer>\n    );\n  }\n\n  private get displayName() {\n    return this.facetState.displayName || 'no-label';\n  }\n\n  private get numberOfSelectedValues() {\n    return (\n      this.facetState.values.filter(({state}) => state === 'selected').length ||\n      0\n    );\n  }\n\n  private get hasInputRange() {\n    return !!this.facetState.manualRange || this.summaryState.isLoading;\n  }\n\n  private get shouldRenderValues() {\n    return !this.hasInputRange && !!this.valuesToRender.length;\n  }\n\n  private get valuesToRender() {\n    return (\n      this.facetState.values.filter(\n        (value) => value.numberOfResults || value.state !== 'idle'\n      ) || []\n    );\n  }\n\n  private get shouldRenderInput() {\n    const {\n      firstRequestExecuted: firstSearchExecuted,\n      hasError,\n      isLoading,\n      hasProducts: hasResults,\n    } = this.summaryState;\n    return shouldDisplayInputForFacetRange({\n      hasInputRange: this.hasInputRange,\n      searchStatusState: {\n        firstSearchExecuted,\n        hasError,\n        hasResults,\n        isLoading,\n      },\n      facetValues: this.facetState.values,\n      hasInput: true,\n    });\n  }\n\n  private get isHidden() {\n    return !this.shouldRenderFacet;\n  }\n\n  private get shouldRenderFacet() {\n    return this.shouldRenderInput || this.shouldRenderValues;\n  }\n\n  private get hasValues() {\n    if (this.facetState.values.length) {\n      return true;\n    }\n\n    return !!this.valuesToRender.length;\n  }\n\n  private ensureSubscribed() {\n    if (this.unsubscribeFacetController) {\n      return;\n    }\n    this.unsubscribeFacetController = this.facet.subscribe(\n      () => (this.facetState = this.facet.state)\n    );\n  }\n}\n","@import '../../../common/facets/facet-common.pcss';\n","import {\n  DateFacet,\n  DateFilterRange,\n  deserializeRelativeDate,\n  DateFacetValue,\n  DateFacetState,\n  DateRangeRequest,\n  SearchSummaryState,\n  ProductListingSummaryState,\n  Summary,\n} from '@coveo/headless/commerce';\nimport {Component, Element, h, Listen, Prop, State, VNode} from '@stencil/core';\nimport {parseDate} from '../../../../utils/date-utils';\nimport {\n  BindStateToController,\n  InitializableComponent,\n  InitializeBindings,\n} from '../../../../utils/initialization-utils';\nimport {FocusTargetController} from '../../../../utils/stencil-accessibility-utils';\nimport {FacetInfo} from '../../../common/facets/facet-common-store';\nimport {FacetContainer} from '../../../common/facets/facet-container/stencil-facet-container';\nimport {FacetGuard} from '../../../common/facets/facet-guard';\nimport {FacetHeader} from '../../../common/facets/facet-header/stencil-facet-header';\nimport {FacetValueLabelHighlight} from '../../../common/facets/facet-value-label-highlight/stencil-facet-value-label-highlight';\nimport {FacetValueLink} from '../../../common/facets/facet-value-link/stencil-facet-value-link';\nimport {FacetValuesGroup} from '../../../common/facets/facet-values-group/stencil-facet-values-group';\nimport {initializePopover} from '../../../common/facets/popover/popover-type';\nimport {shouldDisplayInputForFacetRange} from '../../../common/facets/stencil-facet-common';\nimport {CommerceBindings as Bindings} from '../../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * A facet is a list of values for a certain field occurring in the results.\n * An `atomic-commerce-timeframe-facet` displays a facet of the results for the current query as date intervals.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-timeframe-facet',\n  styleUrl: './atomic-commerce-timeframe-facet.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceTimeframeFacet\n  implements InitializableComponent<Bindings>\n{\n  @InitializeBindings() public bindings!: Bindings;\n  @Element() private host!: HTMLElement;\n\n  /**\n   * The summary controller instance.\n   */\n  @Prop() summary!: Summary<SearchSummaryState | ProductListingSummaryState>;\n  /**\n   * The date facet controller instance.\n   */\n  @Prop() public facet!: DateFacet;\n  /**\n   * Specifies whether the facet is collapsed.\n   */\n  @Prop({reflect: true, mutable: true}) public isCollapsed = false;\n  /**\n   * The field identifier for this facet.\n   */\n  @Prop({reflect: true}) field?: string;\n\n  @State()\n  public facetState!: DateFacetState;\n\n  @BindStateToController('summary')\n  @State()\n  public summaryState!: SearchSummaryState | ProductListingSummaryState;\n\n  @State() public error!: Error;\n\n  @State() private inputRange?: DateFilterRange;\n\n  private headerFocus?: FocusTargetController;\n\n  private get displayName() {\n    return this.facetState.displayName || 'no-label';\n  }\n\n  private get focusTarget(): FocusTargetController {\n    if (!this.headerFocus) {\n      this.headerFocus = new FocusTargetController(this);\n    }\n    return this.headerFocus;\n  }\n\n  private unsubscribeFacetController?: () => void | undefined;\n\n  public initialize() {\n    if (!this.facet) {\n      return;\n    }\n    this.ensureSubscribed();\n    this.registerFacetToStore();\n  }\n\n  public connectedCallback(): void {\n    this.ensureSubscribed();\n  }\n\n  @Listen('atomic/dateInputApply')\n  public applyDateInput({detail}: CustomEvent<DateFilterRange>) {\n    this.inputRange = {start: detail.start, end: detail.end};\n  }\n\n  private get valuesToRender() {\n    return (\n      this.facetState.values.filter(\n        (value) => value.numberOfResults || value.state !== 'idle'\n      ) || []\n    );\n  }\n\n  private get shouldRenderValues() {\n    return !this.hasInputRange && !!this.valuesToRender.length;\n  }\n\n  private get shouldRenderFacet() {\n    return this.shouldRenderInput || this.shouldRenderValues;\n  }\n\n  private get shouldRenderInput() {\n    const {\n      firstRequestExecuted: firstSearchExecuted,\n      hasError,\n      isLoading,\n      hasProducts: hasResults,\n    } = this.summaryState;\n    return shouldDisplayInputForFacetRange({\n      hasInputRange: this.hasInputRange,\n      searchStatusState: {\n        firstSearchExecuted,\n        hasError,\n        hasResults,\n        isLoading,\n      },\n      facetValues: this.facetState.values || [],\n      hasInput: true,\n    });\n  }\n\n  private get hasValues() {\n    if (this.facetState.values.length) {\n      return true;\n    }\n\n    return !!this.valuesToRender.length;\n  }\n\n  private get numberOfSelectedValues() {\n    if (this.hasInputRange) {\n      return 1;\n    }\n\n    return (\n      this.facetState.values.filter(({state}) => state === 'selected').length ||\n      0\n    );\n  }\n\n  private get hasInputRange() {\n    return !!this.inputRange;\n  }\n\n  public disconnectedCallback() {\n    if (this.host.isConnected) {\n      return;\n    }\n    this.unsubscribeFacetController?.();\n    this.unsubscribeFacetController = undefined;\n  }\n\n  private get isHidden() {\n    return !this.shouldRenderFacet;\n  }\n\n  private resetRange() {\n    this.inputRange = undefined;\n    this.facet.setRanges([]);\n  }\n\n  private registerFacetToStore() {\n    const facetInfo: FacetInfo = {\n      label: () => this.bindings.i18n.t(this.displayName),\n      facetId: this.facetState.facetId,\n      element: this.host,\n      isHidden: () => this.isHidden,\n    };\n\n    initializePopover(this.host, {\n      ...facetInfo,\n      hasValues: () => this.hasValues,\n      numberOfActiveValues: () => this.numberOfSelectedValues,\n    });\n  }\n\n  private formatFacetValue(facetValue: DateFacetValue) {\n    try {\n      const startDate = deserializeRelativeDate(facetValue.start);\n      const relativeDate =\n        startDate.period === 'past'\n          ? startDate\n          : deserializeRelativeDate(facetValue.end);\n\n      return this.bindings.i18n.t(\n        `${relativeDate.period}-${relativeDate.unit}`,\n        {\n          count: relativeDate.amount,\n        }\n      );\n    } catch (error) {\n      return this.bindings.i18n.t('to', {\n        start: parseDate(facetValue.start).format('YYYY-MM-DD'),\n        end: parseDate(facetValue.end).format('YYYY-MM-DD'),\n      });\n    }\n  }\n  private renderValues() {\n    return this.renderValuesContainer(\n      this.valuesToRender.map((value) => this.renderValue(value))\n    );\n  }\n\n  private renderValue(facetValue: DateFacetValue) {\n    const displayValue = this.formatFacetValue(facetValue);\n    const isSelected = facetValue.state === 'selected';\n    const isExcluded = facetValue.state === 'excluded';\n    return (\n      <FacetValueLink\n        displayValue={displayValue}\n        isSelected={isSelected}\n        numberOfResults={facetValue.numberOfResults}\n        i18n={this.bindings.i18n}\n        onClick={() => this.facet.toggleSingleSelect(facetValue)}\n      >\n        <FacetValueLabelHighlight\n          displayValue={displayValue}\n          isSelected={isSelected}\n          isExcluded={isExcluded}\n        ></FacetValueLabelHighlight>\n      </FacetValueLink>\n    );\n  }\n\n  private renderValuesContainer(children: VNode[]) {\n    return (\n      <FacetValuesGroup i18n={this.bindings.i18n} label={this.displayName}>\n        <ul class=\"mt-3\" part=\"values\">\n          {children}\n        </ul>\n      </FacetValuesGroup>\n    );\n  }\n\n  private renderHeader() {\n    return (\n      <FacetHeader\n        i18n={this.bindings.i18n}\n        label={this.displayName}\n        onClearFilters={() => {\n          this.focusTarget.focusAfterSearch();\n          if (this.hasInputRange) {\n            this.resetRange();\n            return;\n          }\n          this.facet.deselectAll();\n        }}\n        numberOfActiveValues={this.numberOfSelectedValues}\n        isCollapsed={this.isCollapsed}\n        headingLevel={0}\n        onToggleCollapse={() => (this.isCollapsed = !this.isCollapsed)}\n        headerRef={(el) => this.focusTarget.setTarget(el)}\n      ></FacetHeader>\n    );\n  }\n\n  private renderDateInput() {\n    return (\n      <atomic-facet-date-input\n        bindings={this.bindings}\n        label={this.displayName}\n        rangeGetter={() => this.inputRange}\n        facetId={this.facetState.facetId}\n        rangeSetter={({start, end, endInclusive}: DateRangeRequest) => {\n          this.facet.setRanges([\n            {\n              start,\n              end,\n              endInclusive,\n              state: 'selected',\n            },\n          ]);\n        }}\n      ></atomic-facet-date-input>\n    );\n  }\n\n  public render() {\n    const {hasError, firstRequestExecuted} = this.summaryState;\n\n    return (\n      <FacetGuard\n        enabled={true}\n        firstSearchExecuted={firstRequestExecuted}\n        hasError={hasError}\n        hasResults={this.shouldRenderFacet}\n      >\n        {\n          <FacetContainer>\n            {this.renderHeader()}\n            {!this.isCollapsed && [\n              this.shouldRenderValues && this.renderValues(),\n              this.shouldRenderInput && this.renderDateInput(),\n            ]}\n          </FacetContainer>\n        }\n      </FacetGuard>\n    );\n  }\n\n  private ensureSubscribed() {\n    if (this.unsubscribeFacetController) {\n      return;\n    }\n    this.unsubscribeFacetController = this.facet.subscribe(\n      () => (this.facetState = this.facet.state)\n    );\n  }\n}\n"],"version":3}